import{c as P,r as i,j as e,L as A}from"./index-CJWcQEdu.js";import{U as k,P as B}from"./papaparse.min-C6frpKNi.js";import{parseSamplesFromCSV as z}from"./csvService-BmhBin9I.js";import{a as y,C as _}from"./tdsCalculator-BKwsfyiu.js";import{A as F}from"./arrow-left-BHpt5k8Z.js";import{R as S,T as v,C as L}from"./triangle-alert-CxHCbKtk.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],V=P("Info",R),K=()=>{const[h,g]=i.useState(!1),[f,x]=i.useState(null),[u,C]=i.useState([]),[m,w]=i.useState({normalCode:"",normalMode:"",expertCode:"",expertMode:""}),[U,M]=i.useState(null),[I,E]=i.useState(null),j=async s=>{g(!0),x(null);try{const t=B.parse(s,{header:!0,skipEmptyLines:!0});t.errors.length>0&&console.warn("CSV Parse errors",t.errors);const l=z(t.data,"en"),a=l.find(o=>{var r;return o.sampleCode==="TDS_basic"||((r=o.tdsProfile)==null?void 0:r.mode)==="normal"}),n=l.find(o=>{var r;return o.sampleCode==="TDS_expert"||((r=o.tdsProfile)==null?void 0:r.mode)==="expert"});if(!a||!n)throw new Error("Could not find both 'TDS_basic' (Normal) and 'TDS_expert' (Expert) samples in the CSV.");if(!a.tdsProfile||!n.tdsProfile)throw new Error("Missing TDS Profile data in one or both samples.");w({normalCode:a.sampleCode,normalMode:a.tdsProfile.mode,expertCode:n.sampleCode,expertMode:n.tdsProfile.mode});const c=y(a.tdsProfile),p=y(n.tdsProfile);M(c),E(p);const D=_.map(o=>{var b,N;const r=c.coreScores.get(o)||c.scores.get(o),d=p.coreScores.get(o)||p.scores.get(o);return{attribute:o,normalScore:(r==null?void 0:r.score)||0,expertScore:(d==null?void 0:d.score)||0,normalBoost:((b=r==null?void 0:r.boostDetails)==null?void 0:b.amount)||0,expertBoost:((N=d==null?void 0:d.boostDetails)==null?void 0:N.amount)||0}});C(D)}catch(t){x(t.message||"An error occurred during comparison.")}finally{g(!1)}};i.useEffect(()=>{fetch("/mode_comparison.csv").then(s=>{if(!s.ok)throw new Error("Failed to fetch default CSV");return s.text()}).then(s=>j(s)).catch(s=>x("Failed to load default CSV: "+s.message))},[]);const T=s=>{var a;const t=(a=s.target.files)==null?void 0:a[0];if(!t)return;const l=new FileReader;l.onload=n=>{var c;(c=n.target)!=null&&c.result&&j(n.target.result)},l.readAsText(t)};return e.jsx("div",{className:"min-h-screen bg-stone-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(A,{to:"/",className:"p-2 rounded-full hover:bg-stone-200 transition-colors",children:e.jsx(F,{className:"w-6 h-6 text-stone-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-stone-800",children:"TDS Mode Comparison"}),e.jsx("p",{className:"text-stone-500",children:"Normal vs Expert Mode Algorithm Analysis"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-stone-200 hover:bg-stone-300 rounded-lg cursor-pointer transition-colors text-stone-700 font-medium text-sm",children:[e.jsx(k,{size:18}),"Upload CSV",e.jsx("input",{type:"file",accept:".csv, text/csv, application/vnd.ms-excel",className:"hidden",onChange:T})]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"p-2 bg-stone-200 hover:bg-stone-300 rounded-lg text-stone-700 transition-colors",title:"Reload",children:e.jsx(S,{size:18})})]})]}),f&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3 text-red-700",children:[e.jsx(v,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),e.jsx("p",{children:f})]}),h&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-stone-300 border-t-stone-600"}),e.jsx("p",{className:"mt-2 text-stone-500",children:"Analyzing TDS Profiles..."})]}),!h&&u.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-stone-200 overflow-hidden mb-8",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-stone-100 text-stone-600 font-semibold uppercase tracking-wider",children:e.jsxs("tr",{className:"border-b border-stone-200",children:[e.jsx("th",{className:"px-6 py-4",children:"Core Attribute"}),e.jsxs("th",{className:"px-6 py-4 text-center bg-blue-50",children:["Normal Mode Score",e.jsxs("div",{className:"text-xs text-blue-400 font-normal mt-1",children:[m.normalCode," (",m.normalMode,")"]})]}),e.jsxs("th",{className:"px-6 py-4 text-center bg-purple-50",children:["Expert Mode Score",e.jsxs("div",{className:"text-xs text-purple-400 font-normal mt-1",children:[m.expertCode," (",m.expertMode,")"]})]}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Difference"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-stone-100",children:u.map(s=>{const t=s.normalScore-s.expertScore,l=Math.abs(t)>=2;return e.jsxs("tr",{className:"hover:bg-stone-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-stone-800 capitalize",children:s.attribute}),e.jsxs("td",{className:"px-6 py-4 text-center bg-blue-50/30",children:[e.jsx("span",{className:"font-bold text-lg",children:s.normalScore}),s.normalBoost>0&&e.jsxs("span",{className:"ml-2 text-xs text-indigo-600 font-bold",children:["(+",s.normalBoost," rec)"]})]}),e.jsxs("td",{className:"px-6 py-4 text-center bg-purple-50/30",children:[e.jsx("span",{className:"font-bold text-lg",children:s.expertScore}),s.expertBoost>0&&e.jsxs("span",{className:"ml-2 text-xs text-indigo-600 font-bold",children:["(+",s.expertBoost," rec)"]})]}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("span",{className:`px-2 py-1 rounded font-bold ${t>0?"bg-green-100 text-green-700":t<0?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"}`,children:[t>0?"+":"",t]})}),e.jsx("td",{className:"px-6 py-4 text-center",children:l?e.jsxs("span",{className:"flex items-center justify-center gap-1 text-amber-600 font-medium",children:[e.jsx(v,{size:16})," Deviation"]}):e.jsxs("span",{className:"flex items-center justify-center gap-1 text-green-600 font-medium",children:[e.jsx(L,{size:16})," Aligned"]})})]},s.attribute)})})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-xl p-6 border border-blue-100",children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-900 mb-4 flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5"}),"Insights"]}),e.jsxs("ul",{className:"space-y-3 text-blue-800 text-sm",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"No Normalization Summation:"})," Expert mode now calculates Core Scores based ",e.jsx("em",{children:"only"})," on the Core attribute's own duration (matching Normal mode)."]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-bold",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Recommendation Boosts:"})," Instead of hiding child attributes in the score, significant child attribute presence (e.g., Berry, Citrus) triggers a ",e.jsx("strong",{children:"Recommendation Boost (+1 or +2)"})," visible as separate guidance."]})]})]})]}),e.jsxs("div",{className:"bg-indigo-50 rounded-xl p-6 border border-indigo-100",children:[e.jsxs("h3",{className:"text-lg font-bold text-indigo-900 mb-4 flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5"}),"Tweaking Recommendations"]}),e.jsxs("div",{className:"space-y-4 text-indigo-900 text-sm",children:[e.jsxs("p",{children:["If ",e.jsx("strong",{children:"Normal Mode Scores"})," are consistently lower:"]}),e.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[e.jsxs("li",{children:["Consider ",e.jsx("strong",{children:"lowering the dominance threshold"})," for Normal Mode score mapping."]}),e.jsxs("li",{children:["Apply a ",e.jsx("strong",{children:"multiplier (e.g., 1.2x)"})," to durations in Normal Mode to account for slower reaction/decision times when selecting broad categories."]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-white rounded border border-indigo-200 text-xs",children:[e.jsx("strong",{children:"Proposed Experiment:"})," If deviations ",">"," 2 points persist, modify ",e.jsx("code",{children:"tdsCalculator.ts"})," to reduce the sensitivity curve strictness specifically for ",e.jsx("code",{children:"mode === 'normal'"}),"."]})]})]})]})]})]})})};export{K as default};
