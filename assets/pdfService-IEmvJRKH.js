import{j as at,E as it}from"./jspdf.es.min-Dqj2srgi.js";import{m as rt,i as ot,k as X,b as G}from"./index-CJWcQEdu.js";import{A as Z}from"./attributes-zDdy4c7G.js";import{g as V,C as et,r as lt}from"./dbService-gir1Ecq8.js";import{a as tt}from"./tdsCalculator-BKwsfyiu.js";import{f as st,b as ft}from"./dateUtils-BSM0ms4X.js";var nt={exports:{}};const ut=rt(at);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(N,Q){(function(M,x){N.exports=x(function(){try{return ut}catch{}}())})(typeof globalThis<"u"?globalThis:typeof X<"u"?X:typeof window<"u"?window:typeof self<"u"?self:X,function(I){return function(){var M={172:function(z,v){var W=this&&this.__extends||function(){var c=function(o,i){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,y){P.__proto__=y}||function(P,y){for(var l in y)Object.prototype.hasOwnProperty.call(y,l)&&(P[l]=y[l])},c(o,i)};return function(o,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");c(o,i);function P(){this.constructor=o}o.prototype=i===null?Object.create(i):(P.prototype=i.prototype,new P)}}();Object.defineProperty(v,"__esModule",{value:!0}),v.CellHookData=v.HookData=void 0;var F=function(){function c(o,i,P){this.table=i,this.pageNumber=i.pageNumber,this.pageCount=this.pageNumber,this.settings=i.settings,this.cursor=P,this.doc=o.getDocument()}return c}();v.HookData=F;var D=function(c){W(o,c);function o(i,P,y,l,e,t){var n=c.call(this,i,P,t)||this;return n.cell=y,n.row=l,n.column=e,n.section=l.section,n}return o}(F);v.CellHookData=D},340:function(z,v,W){Object.defineProperty(v,"__esModule",{value:!0});var F=W(4),D=W(136),c=W(744),o=W(776),i=W(664),P=W(972);function y(l){l.API.autoTable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n;e.length===1?n=e[0]:(console.error("Use of deprecated autoTable initiation"),n=e[2]||{},n.columns=e[0],n.body=e[1]);var f=(0,o.parseInput)(this,n),d=(0,P.createTable)(this,f);return(0,i.drawTable)(this,d),this},l.API.lastAutoTable=!1,l.API.previousAutoTable=!1,l.API.autoTable.previous=!1,l.API.autoTableText=function(e,t,n,f){(0,D.default)(e,t,n,f,this)},l.API.autoTableSetDefaults=function(e){return c.DocHandler.setDefaults(e,this),this},l.autoTableSetDefaults=function(e,t){c.DocHandler.setDefaults(e,t)},l.API.autoTableHtmlToJson=function(e,t){var n;if(t===void 0&&(t=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var f=new c.DocHandler(this),d=(0,F.parseHtml)(f,e,window,t,!1),a=d.head,u=d.body,S=((n=a[0])===null||n===void 0?void 0:n.map(function(m){return m.content}))||[];return{columns:S,rows:u,data:u}},l.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var e=this.lastAutoTable;return e&&e.finalY?e.finalY:0},l.API.autoTableAddPageContent=function(e){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),l.API.autoTable.globalDefaults||(l.API.autoTable.globalDefaults={}),l.API.autoTable.globalDefaults.addPageContent=e,this},l.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}v.default=y},136:function(z,v){Object.defineProperty(v,"__esModule",{value:!0});function W(F,D,c,o,i){o=o||{};var P=1.15,y=i.internal.scaleFactor,l=i.internal.getFontSize()/y,e=i.getLineHeightFactor?i.getLineHeightFactor():P,t=l*e,n=/\r\n|\r|\n/g,f="",d=1;if((o.valign==="middle"||o.valign==="bottom"||o.halign==="center"||o.halign==="right")&&(f=typeof F=="string"?F.split(n):F,d=f.length||1),c+=l*(2-P),o.valign==="middle"?c-=d/2*t:o.valign==="bottom"&&(c-=d*t),o.halign==="center"||o.halign==="right"){var a=l;if(o.halign==="center"&&(a*=.5),f&&d>=1){for(var u=0;u<f.length;u++)i.text(f[u],D-i.getStringUnitWidth(f[u])*a,c),c+=t;return i}D-=i.getStringUnitWidth(F)*a}return o.halign==="justify"?i.text(F,D,c,{maxWidth:o.maxWidth||100,align:"justify"}):i.text(F,D,c),i}v.default=W},420:function(z,v){Object.defineProperty(v,"__esModule",{value:!0}),v.getPageAvailableWidth=v.parseSpacing=v.getFillStyle=v.addTableBorder=v.getStringWidth=void 0;function W(i,P,y){y.applyStyles(P,!0);var l=Array.isArray(i)?i:[i],e=l.map(function(t){return y.getTextWidth(t)}).reduce(function(t,n){return Math.max(t,n)},0);return e}v.getStringWidth=W;function F(i,P,y,l){var e=P.settings.tableLineWidth,t=P.settings.tableLineColor;i.applyStyles({lineWidth:e,lineColor:t});var n=D(e,!1);n&&i.rect(y.x,y.y,P.getWidth(i.pageSize().width),l.y-y.y,n)}v.addTableBorder=F;function D(i,P){var y=i>0,l=P||P===0;return y&&l?"DF":y?"S":l?"F":null}v.getFillStyle=D;function c(i,P){var y,l,e,t;if(i=i||P,Array.isArray(i)){if(i.length>=4)return{top:i[0],right:i[1],bottom:i[2],left:i[3]};if(i.length===3)return{top:i[0],right:i[1],bottom:i[2],left:i[1]};if(i.length===2)return{top:i[0],right:i[1],bottom:i[0],left:i[1]};i.length===1?i=i[0]:i=P}return typeof i=="object"?(typeof i.vertical=="number"&&(i.top=i.vertical,i.bottom=i.vertical),typeof i.horizontal=="number"&&(i.right=i.horizontal,i.left=i.horizontal),{left:(y=i.left)!==null&&y!==void 0?y:P,top:(l=i.top)!==null&&l!==void 0?l:P,right:(e=i.right)!==null&&e!==void 0?e:P,bottom:(t=i.bottom)!==null&&t!==void 0?t:P}):(typeof i!="number"&&(i=P),{top:i,right:i,bottom:i,left:i})}v.parseSpacing=c;function o(i,P){var y=c(P.settings.margin,0);return i.pageSize().width-(y.left+y.right)}v.getPageAvailableWidth=o},796:function(z,v){var W=this&&this.__extends||function(){var o=function(i,P){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,l){y.__proto__=l}||function(y,l){for(var e in l)Object.prototype.hasOwnProperty.call(l,e)&&(y[e]=l[e])},o(i,P)};return function(i,P){if(typeof P!="function"&&P!==null)throw new TypeError("Class extends value "+String(P)+" is not a constructor or null");o(i,P);function y(){this.constructor=i}i.prototype=P===null?Object.create(P):(y.prototype=P.prototype,new y)}}();Object.defineProperty(v,"__esModule",{value:!0}),v.getTheme=v.defaultStyles=v.HtmlRowInput=void 0;var F=function(o){W(i,o);function i(P){var y=o.call(this)||this;return y._element=P,y}return i}(Array);v.HtmlRowInput=F;function D(o){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/o,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}v.defaultStyles=D;function c(o){var i={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return i[o]}v.getTheme=c},903:function(z,v,W){Object.defineProperty(v,"__esModule",{value:!0}),v.parseCss=void 0;var F=W(420);function D(y,l,e,t,n){var f={},d=1.3333333333333333,a=o(l,function(h){return n.getComputedStyle(h).backgroundColor});a!=null&&(f.fillColor=a);var u=o(l,function(h){return n.getComputedStyle(h).color});u!=null&&(f.textColor=u);var S=P(t,e);S&&(f.cellPadding=S);var m="borderTopColor",p=d*e,s=t.borderTopWidth;if(t.borderBottomWidth===s&&t.borderRightWidth===s&&t.borderLeftWidth===s){var H=(parseFloat(s)||0)/p;H&&(f.lineWidth=H)}else f.lineWidth={top:(parseFloat(t.borderTopWidth)||0)/p,right:(parseFloat(t.borderRightWidth)||0)/p,bottom:(parseFloat(t.borderBottomWidth)||0)/p,left:(parseFloat(t.borderLeftWidth)||0)/p},f.lineWidth.top||(f.lineWidth.right?m="borderRightColor":f.lineWidth.bottom?m="borderBottomColor":f.lineWidth.left&&(m="borderLeftColor"));var k=o(l,function(h){return n.getComputedStyle(h)[m]});k!=null&&(f.lineColor=k);var E=["left","right","center","justify"];E.indexOf(t.textAlign)!==-1&&(f.halign=t.textAlign),E=["middle","bottom","top"],E.indexOf(t.verticalAlign)!==-1&&(f.valign=t.verticalAlign);var g=parseInt(t.fontSize||"");isNaN(g)||(f.fontSize=g/d);var r=c(t);r&&(f.fontStyle=r);var C=(t.fontFamily||"").toLowerCase();return y.indexOf(C)!==-1&&(f.font=C),f}v.parseCss=D;function c(y){var l="";return(y.fontWeight==="bold"||y.fontWeight==="bolder"||parseInt(y.fontWeight)>=700)&&(l="bold"),(y.fontStyle==="italic"||y.fontStyle==="oblique")&&(l+="italic"),l}function o(y,l){var e=i(y,l);if(!e)return null;var t=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!t||!Array.isArray(t))return null;var n=[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])],f=parseInt(t[4]);return f===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function i(y,l){var e=l(y);return e==="rgba(0, 0, 0, 0)"||e==="transparent"||e==="initial"||e==="inherit"?y.parentElement==null?null:i(y.parentElement,l):e}function P(y,l){var e=[y.paddingTop,y.paddingRight,y.paddingBottom,y.paddingLeft],t=96/(72/l),n=(parseInt(y.lineHeight)-parseInt(y.fontSize))/l/2,f=e.map(function(a){return parseInt(a||"0")/t}),d=(0,F.parseSpacing)(f,0);return n>d.top&&(d.top=n),n>d.bottom&&(d.bottom=n),d}},744:function(z,v){Object.defineProperty(v,"__esModule",{value:!0}),v.DocHandler=void 0;var W={},F=function(){function D(c){this.jsPDFDocument=c,this.userStyles={textColor:c.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:c.internal.getFontSize(),fontStyle:c.internal.getFont().fontStyle,font:c.internal.getFont().fontName,lineWidth:c.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:c.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return D.setDefaults=function(c,o){o===void 0&&(o=null),o?o.__autoTableDocumentDefaults=c:W=c},D.unifyColor=function(c){return Array.isArray(c)?c:typeof c=="number"?[c,c,c]:typeof c=="string"?[c]:null},D.prototype.applyStyles=function(c,o){var i,P,y;o===void 0&&(o=!1),c.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(c.fontStyle);var l=this.jsPDFDocument.internal.getFont(),e=l.fontStyle,t=l.fontName;if(c.font&&(t=c.font),c.fontStyle){e=c.fontStyle;var n=this.getFontList()[t];n&&n.indexOf(e)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(n[0]),e=n[0])}if(this.jsPDFDocument.setFont(t,e),c.fontSize&&this.jsPDFDocument.setFontSize(c.fontSize),!o){var f=D.unifyColor(c.fillColor);f&&(i=this.jsPDFDocument).setFillColor.apply(i,f),f=D.unifyColor(c.textColor),f&&(P=this.jsPDFDocument).setTextColor.apply(P,f),f=D.unifyColor(c.lineColor),f&&(y=this.jsPDFDocument).setDrawColor.apply(y,f),typeof c.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(c.lineWidth)}},D.prototype.splitTextToSize=function(c,o,i){return this.jsPDFDocument.splitTextToSize(c,o,i)},D.prototype.rect=function(c,o,i,P,y){return this.jsPDFDocument.rect(c,o,i,P,y)},D.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},D.prototype.getTextWidth=function(c){return this.jsPDFDocument.getTextWidth(c)},D.prototype.getDocument=function(){return this.jsPDFDocument},D.prototype.setPage=function(c){this.jsPDFDocument.setPage(c)},D.prototype.addPage=function(){return this.jsPDFDocument.addPage()},D.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},D.prototype.getGlobalOptions=function(){return W||{}},D.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},D.prototype.pageSize=function(){var c=this.jsPDFDocument.internal.pageSize;return c.width==null&&(c={width:c.getWidth(),height:c.getHeight()}),c},D.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},D.prototype.getLineHeightFactor=function(){var c=this.jsPDFDocument;return c.getLineHeightFactor?c.getLineHeightFactor():1.15},D.prototype.getLineHeight=function(c){return c/this.scaleFactor()*this.getLineHeightFactor()},D.prototype.pageNumber=function(){var c=this.jsPDFDocument.internal.getCurrentPageInfo();return c?c.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},D}();v.DocHandler=F},4:function(z,v,W){Object.defineProperty(v,"__esModule",{value:!0}),v.parseHtml=void 0;var F=W(903),D=W(796);function c(P,y,l,e,t){var n,f;e===void 0&&(e=!1),t===void 0&&(t=!1);var d;typeof y=="string"?d=l.document.querySelector(y):d=y;var a=Object.keys(P.getFontList()),u=P.scaleFactor(),S=[],m=[],p=[];if(!d)return console.error("Html table could not be found with input: ",y),{head:S,body:m,foot:p};for(var s=0;s<d.rows.length;s++){var H=d.rows[s],k=(f=(n=H==null?void 0:H.parentElement)===null||n===void 0?void 0:n.tagName)===null||f===void 0?void 0:f.toLowerCase(),E=o(a,u,l,H,e,t);E&&(k==="thead"?S.push(E):k==="tfoot"?p.push(E):m.push(E))}return{head:S,body:m,foot:p}}v.parseHtml=c;function o(P,y,l,e,t,n){for(var f=new D.HtmlRowInput(e),d=0;d<e.cells.length;d++){var a=e.cells[d],u=l.getComputedStyle(a);if(t||u.display!=="none"){var S=void 0;n&&(S=(0,F.parseCss)(P,a,y,u,l)),f.push({rowSpan:a.rowSpan,colSpan:a.colSpan,styles:S,_element:a,content:i(a)})}}var m=l.getComputedStyle(e);if(f.length>0&&(t||m.display!=="none"))return f}function i(P){var y=P.cloneNode(!0);return y.innerHTML=y.innerHTML.replace(/\n/g,"").replace(/ +/g," "),y.innerHTML=y.innerHTML.split(/<br.*?>/).map(function(l){return l.trim()}).join(`
`),y.innerText||y.textContent||""}},776:function(z,v,W){Object.defineProperty(v,"__esModule",{value:!0}),v.parseInput=void 0;var F=W(4),D=W(356),c=W(420),o=W(744),i=W(792);function P(d,a){var u=new o.DocHandler(d),S=u.getDocumentOptions(),m=u.getGlobalOptions();(0,i.default)(u,m,S,a);var p=(0,D.assign)({},m,S,a),s;typeof window<"u"&&(s=window);var H=y(m,S,a),k=l(m,S,a),E=e(u,p),g=n(u,p,s);return{id:a.tableId,content:g,hooks:k,styles:H,settings:E}}v.parseInput=P;function y(d,a,u){for(var S={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},m=function(k){if(k==="columnStyles"){var E=d[k],g=a[k],r=u[k];S.columnStyles=(0,D.assign)({},E,g,r)}else{var C=[d,a,u],h=C.map(function(T){return T[k]||{}});S[k]=(0,D.assign)({},h[0],h[1],h[2])}},p=0,s=Object.keys(S);p<s.length;p++){var H=s[p];m(H)}return S}function l(d,a,u){for(var S=[d,a,u],m={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},p=0,s=S;p<s.length;p++){var H=s[p];H.didParseCell&&m.didParseCell.push(H.didParseCell),H.willDrawCell&&m.willDrawCell.push(H.willDrawCell),H.didDrawCell&&m.didDrawCell.push(H.didDrawCell),H.willDrawPage&&m.willDrawPage.push(H.willDrawPage),H.didDrawPage&&m.didDrawPage.push(H.didDrawPage)}return m}function e(d,a){var u,S,m,p,s,H,k,E,g,r,C,h,T=(0,c.parseSpacing)(a.margin,40/d.scaleFactor()),w=(u=t(d,a.startY))!==null&&u!==void 0?u:T.top,b;a.showFoot===!0?b="everyPage":a.showFoot===!1?b="never":b=(S=a.showFoot)!==null&&S!==void 0?S:"everyPage";var A;a.showHead===!0?A="everyPage":a.showHead===!1?A="never":A=(m=a.showHead)!==null&&m!==void 0?m:"everyPage";var _=(p=a.useCss)!==null&&p!==void 0?p:!1,j=a.theme||(_?"plain":"striped"),R=!!a.horizontalPageBreak,B=(s=a.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(H=a.includeHiddenHtml)!==null&&H!==void 0?H:!1,useCss:_,theme:j,startY:w,margin:T,pageBreak:(k=a.pageBreak)!==null&&k!==void 0?k:"auto",rowPageBreak:(E=a.rowPageBreak)!==null&&E!==void 0?E:"auto",tableWidth:(g=a.tableWidth)!==null&&g!==void 0?g:"auto",showHead:A,showFoot:b,tableLineWidth:(r=a.tableLineWidth)!==null&&r!==void 0?r:0,tableLineColor:(C=a.tableLineColor)!==null&&C!==void 0?C:200,horizontalPageBreak:R,horizontalPageBreakRepeat:B,horizontalPageBreakBehaviour:(h=a.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function t(d,a){var u=d.getLastAutoTable(),S=d.scaleFactor(),m=d.pageNumber(),p=!1;if(u&&u.startPageNumber){var s=u.startPageNumber+u.pageNumber-1;p=s===m}return typeof a=="number"?a:(a==null||a===!1)&&p&&(u==null?void 0:u.finalY)!=null?u.finalY+20/S:null}function n(d,a,u){var S=a.head||[],m=a.body||[],p=a.foot||[];if(a.html){var s=a.includeHiddenHtml;if(u){var H=(0,F.parseHtml)(d,a.html,u,s,a.useCss)||{};S=H.head||S,m=H.body||S,p=H.foot||S}else console.error("Cannot parse html in non browser environment")}var k=a.columns||f(S,m,p);return{columns:k,head:S,body:m,foot:p}}function f(d,a,u){var S=d[0]||a[0]||u[0]||[],m=[];return Object.keys(S).filter(function(p){return p!=="_element"}).forEach(function(p){var s=1,H;Array.isArray(S)?H=S[parseInt(p)]:H=S[p],typeof H=="object"&&!Array.isArray(H)&&(s=(H==null?void 0:H.colSpan)||1);for(var k=0;k<s;k++){var E=void 0;Array.isArray(S)?E=m.length:E=p+(k>0?"_".concat(k):"");var g={dataKey:E};m.push(g)}}),m}},792:function(z,v){Object.defineProperty(v,"__esModule",{value:!0});function W(D,c,o,i){for(var P=function(t){t&&typeof t!="object"&&console.error("The options parameter should be of type object, is: "+typeof t),typeof t.extendWidth<"u"&&(t.tableWidth=t.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof t.margins<"u"&&(typeof t.margin>"u"&&(t.margin=t.margins),console.error("Use of deprecated option: margins, use margin instead.")),t.startY&&typeof t.startY!="number"&&(console.error("Invalid value for startY option",t.startY),delete t.startY),!t.didDrawPage&&(t.afterPageContent||t.beforePageContent||t.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),t.didDrawPage=function(p){D.applyStyles(D.userStyles),t.beforePageContent&&t.beforePageContent(p),D.applyStyles(D.userStyles),t.afterPageContent&&t.afterPageContent(p),D.applyStyles(D.userStyles),t.afterPageAdd&&p.pageNumber>1&&p.afterPageAdd(p),D.applyStyles(D.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(p){t[p]&&console.error('The "'.concat(p,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(p){var s=p[0],H=p[1];t[H]&&(console.error("Use of deprecated option ".concat(H,". Use ").concat(s," instead")),t[s]=t[H])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(p){var s=typeof p=="string"?p:p[0],H=typeof p=="string"?p:p[1];typeof t[s]<"u"&&(typeof t.styles[H]>"u"&&(t.styles[H]=t[s]),console.error("Use of deprecated option: "+s+", use the style "+H+" instead."))});for(var n=0,f=["styles","bodyStyles","headStyles","footStyles"];n<f.length;n++){var d=f[n];F(t[d]||{})}for(var a=t.columnStyles||{},u=0,S=Object.keys(a);u<S.length;u++){var m=S[u];F(a[m]||{})}},y=0,l=[c,o,i];y<l.length;y++){var e=l[y];P(e)}}v.default=W;function F(D){D.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),D.minCellHeight||(D.minCellHeight=D.rowHeight)):D.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),D.cellWidth||(D.cellWidth=D.columnWidth))}},260:function(z,v,W){Object.defineProperty(v,"__esModule",{value:!0}),v.Column=v.Cell=v.Row=v.Table=void 0;var F=W(796),D=W(172),c=W(420),o=function(){function l(e,t){this.pageNumber=1,this.pageCount=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return l.prototype.getHeadHeight=function(e){return this.head.reduce(function(t,n){return t+n.getMaxCellHeight(e)},0)},l.prototype.getFootHeight=function(e){return this.foot.reduce(function(t,n){return t+n.getMaxCellHeight(e)},0)},l.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},l.prototype.callCellHooks=function(e,t,n,f,d,a){for(var u=0,S=t;u<S.length;u++){var m=S[u],p=new D.CellHookData(e,this,n,f,d,a),s=m(p)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],s)return!1}return!0},l.prototype.callEndPageHooks=function(e,t){e.applyStyles(e.userStyles);for(var n=0,f=this.hooks.didDrawPage;n<f.length;n++){var d=f[n];d(new D.HookData(e,this,t))}},l.prototype.callWillDrawPageHooks=function(e,t){for(var n=0,f=this.hooks.willDrawPage;n<f.length;n++){var d=f[n];d(new D.HookData(e,this,t))}},l.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var t=this.columns.reduce(function(f,d){return f+d.wrappedWidth},0);return t}else{var n=this.settings.margin;return e-n.left-n.right}},l}();v.Table=o;var i=function(){function l(e,t,n,f,d){d===void 0&&(d=!1),this.height=0,this.raw=e,e instanceof F.HtmlRowInput&&(this.raw=e._element,this.element=e._element),this.index=t,this.section=n,this.cells=f,this.spansMultiplePages=d}return l.prototype.getMaxCellHeight=function(e){var t=this;return e.reduce(function(n,f){var d;return Math.max(n,((d=t.cells[f.index])===null||d===void 0?void 0:d.height)||0)},0)},l.prototype.hasRowSpan=function(e){var t=this;return e.filter(function(n){var f=t.cells[n.index];return f?f.rowSpan>1:!1}).length>0},l.prototype.canEntireRowFit=function(e,t){return this.getMaxCellHeight(t)<=e},l.prototype.getMinimumRowHeight=function(e,t){var n=this;return e.reduce(function(f,d){var a=n.cells[d.index];if(!a)return 0;var u=t.getLineHeight(a.styles.fontSize),S=a.padding("vertical"),m=S+u;return m>f?m:f},0)},l}();v.Row=i;var P=function(){function l(e,t,n){var f,d;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=n,this.raw=e;var a=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,a=(d=(f=e.content)!==null&&f!==void 0?f:e.title)!==null&&d!==void 0?d:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var u=a!=null?""+a:"",S=/\r\n|\r|\n/g;this.text=u.split(S)}return l.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var t=this.height-this.padding("vertical");e=this.y+t/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var f=this.width-this.padding("horizontal");n=this.x+f/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:e}},l.prototype.getContentHeight=function(e,t){t===void 0&&(t=1.15);var n=Array.isArray(this.text)?this.text.length:1,f=this.styles.fontSize/e*t,d=n*f+this.padding("vertical");return Math.max(d,this.styles.minCellHeight)},l.prototype.padding=function(e){var t=(0,c.parseSpacing)(this.styles.cellPadding,0);return e==="vertical"?t.top+t.bottom:e==="horizontal"?t.left+t.right:t[e]},l}();v.Cell=P;var y=function(){function l(e,t,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=t,this.index=n}return l.prototype.getMaxCustomCellWidth=function(e){for(var t=0,n=0,f=e.allRows();n<f.length;n++){var d=f[n],a=d.cells[this.index];a&&typeof a.styles.cellWidth=="number"&&(t=Math.max(t,a.styles.cellWidth))}return t},l}();v.Column=y},356:function(z,v){Object.defineProperty(v,"__esModule",{value:!0}),v.assign=void 0;function W(F,D,c,o,i){if(F==null)throw new TypeError("Cannot convert undefined or null to object");for(var P=Object(F),y=1;y<arguments.length;y++){var l=arguments[y];if(l!=null)for(var e in l)Object.prototype.hasOwnProperty.call(l,e)&&(P[e]=l[e])}return P}v.assign=W},972:function(z,v,W){Object.defineProperty(v,"__esModule",{value:!0}),v.createTable=void 0;var F=W(744),D=W(260),c=W(324),o=W(796),i=W(356);function P(d,a){var u=new F.DocHandler(d),S=y(a,u.scaleFactor()),m=new D.Table(a,S);return(0,c.calculateWidths)(u,m),u.applyStyles(u.userStyles),m}v.createTable=P;function y(d,a){var u=d.content,S=n(u.columns);if(u.head.length===0){var m=e(S,"head");m&&u.head.push(m)}if(u.foot.length===0){var m=e(S,"foot");m&&u.foot.push(m)}var p=d.settings.theme,s=d.styles;return{columns:S,head:l("head",u.head,S,s,p,a),body:l("body",u.body,S,s,p,a),foot:l("foot",u.foot,S,s,p,a)}}function l(d,a,u,S,m,p){var s={},H=a.map(function(k,E){for(var g=0,r={},C=0,h=0,T=0,w=u;T<w.length;T++){var b=w[T];if(s[b.index]==null||s[b.index].left===0)if(h===0){var A=void 0;Array.isArray(k)?A=k[b.index-C-g]:A=k[b.dataKey];var _={};typeof A=="object"&&!Array.isArray(A)&&(_=(A==null?void 0:A.styles)||{});var j=f(d,b,E,m,S,p,_),R=new D.Cell(A,j,d);r[b.dataKey]=R,r[b.index]=R,h=R.colSpan-1,s[b.index]={left:R.rowSpan-1,times:h}}else h--,C++;else s[b.index].left--,h=s[b.index].times,g++}return new D.Row(k,E,d,r)});return H}function e(d,a){var u={};return d.forEach(function(S){if(S.raw!=null){var m=t(a,S.raw);m!=null&&(u[S.dataKey]=m)}}),Object.keys(u).length>0?u:null}function t(d,a){if(d==="head"){if(typeof a=="object")return a.header||a.title||null;if(typeof a=="string"||typeof a=="number")return a}else if(d==="foot"&&typeof a=="object")return a.footer;return null}function n(d){return d.map(function(a,u){var S,m,p;return typeof a=="object"?p=(m=(S=a.dataKey)!==null&&S!==void 0?S:a.key)!==null&&m!==void 0?m:u:p=u,new D.Column(p,a,u)})}function f(d,a,u,S,m,p,s){var H=(0,o.getTheme)(S),k;d==="head"?k=m.headStyles:d==="body"?k=m.bodyStyles:d==="foot"&&(k=m.footStyles);var E=(0,i.assign)({},H.table,H[d],m.styles,k),g=m.columnStyles[a.dataKey]||m.columnStyles[a.index]||{},r=d==="body"?g:{},C=d==="body"&&u%2===0?(0,i.assign)({},H.alternateRow,m.alternateRowStyles):{},h=(0,o.defaultStyles)(p),T=(0,i.assign)({},h,E,C,r);return(0,i.assign)(T,s)}},664:function(z,v,W){Object.defineProperty(v,"__esModule",{value:!0}),v.addPage=v.drawTable=void 0;var F=W(420),D=W(260),c=W(744),o=W(356),i=W(136),P=W(224);function y(g,r){var C=r.settings,h=C.startY,T=C.margin,w={x:T.left,y:h},b=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns),A=h+T.bottom+b;if(C.pageBreak==="avoid"){var _=r.body,j=_.reduce(function(O,Y){return O+Y.height},0);A+=j}var R=new c.DocHandler(g);(C.pageBreak==="always"||C.startY!=null&&A>R.pageSize().height)&&(E(R),w.y=T.top),r.callWillDrawPageHooks(R,w);var B=(0,o.assign)({},w);r.startPageNumber=R.pageNumber(),C.horizontalPageBreak?l(R,r,B,w):(R.applyStyles(R.userStyles),(C.showHead==="firstPage"||C.showHead==="everyPage")&&r.head.forEach(function(O){return m(R,r,O,w,r.columns)}),R.applyStyles(R.userStyles),r.body.forEach(function(O,Y){var K=Y===r.body.length-1;S(R,r,O,K,B,w,r.columns)}),R.applyStyles(R.userStyles),(C.showFoot==="lastPage"||C.showFoot==="everyPage")&&r.foot.forEach(function(O){return m(R,r,O,w,r.columns)})),(0,F.addTableBorder)(R,r,B,w),r.callEndPageHooks(R,w),r.finalY=w.y,g.lastAutoTable=r,g.previousAutoTable=r,g.autoTable&&(g.autoTable.previous=r),R.applyStyles(R.userStyles)}v.drawTable=y;function l(g,r,C,h){var T=(0,P.calculateAllColumnsCanFitInPage)(g,r),w=r.settings;if(w.horizontalPageBreakBehaviour==="afterAllRows")T.forEach(function(j,R){g.applyStyles(g.userStyles),R>0?k(g,r,C,h,j.columns,!0):e(g,r,h,j.columns),t(g,r,C,h,j.columns),f(g,r,h,j.columns)});else for(var b=-1,A=T[0],_=function(){var j=b;if(A){g.applyStyles(g.userStyles);var R=A.columns;b>=0?k(g,r,C,h,R,!0):e(g,r,h,R),j=n(g,r,b+1,h,R),f(g,r,h,R)}var B=j-b;T.slice(1).forEach(function(O){g.applyStyles(g.userStyles),k(g,r,C,h,O.columns,!0),n(g,r,b+1,h,O.columns,B),f(g,r,h,O.columns)}),b=j};b<r.body.length-1;)_()}function e(g,r,C,h){var T=r.settings;g.applyStyles(g.userStyles),(T.showHead==="firstPage"||T.showHead==="everyPage")&&r.head.forEach(function(w){return m(g,r,w,C,h)})}function t(g,r,C,h,T){g.applyStyles(g.userStyles),r.body.forEach(function(w,b){var A=b===r.body.length-1;S(g,r,w,A,C,h,T)})}function n(g,r,C,h,T,w){g.applyStyles(g.userStyles),w=w??r.body.length;var b=Math.min(C+w,r.body.length),A=-1;return r.body.slice(C,b).forEach(function(_,j){var R=C+j===r.body.length-1,B=H(g,r,R,h);_.canEntireRowFit(B,T)&&(m(g,r,_,h,T),A=C+j)}),A}function f(g,r,C,h){var T=r.settings;g.applyStyles(g.userStyles),(T.showFoot==="lastPage"||T.showFoot==="everyPage")&&r.foot.forEach(function(w){return m(g,r,w,C,h)})}function d(g,r,C){var h=C.getLineHeight(g.styles.fontSize),T=g.padding("vertical"),w=Math.floor((r-T)/h);return Math.max(0,w)}function a(g,r,C,h){var T={};g.spansMultiplePages=!0,g.height=0;for(var w=0,b=0,A=C.columns;b<A.length;b++){var _=A[b],j=g.cells[_.index];if(j){Array.isArray(j.text)||(j.text=[j.text]);var R=new D.Cell(j.raw,j.styles,j.section);R=(0,o.assign)(R,j),R.text=[];var B=d(j,r,h);j.text.length>B&&(R.text=j.text.splice(B,j.text.length));var O=h.scaleFactor(),Y=h.getLineHeightFactor();j.contentHeight=j.getContentHeight(O,Y),j.contentHeight>=r&&(j.contentHeight=r,R.styles.minCellHeight-=r),j.contentHeight>g.height&&(g.height=j.contentHeight),R.contentHeight=R.getContentHeight(O,Y),R.contentHeight>w&&(w=R.contentHeight),T[_.index]=R}}var K=new D.Row(g.raw,-1,g.section,T,!0);K.height=w;for(var J=0,$=C.columns;J<$.length;J++){var _=$[J],R=K.cells[_.index];R&&(R.height=K.height);var j=g.cells[_.index];j&&(j.height=g.height)}return K}function u(g,r,C,h){var T=g.pageSize().height,w=h.settings.margin,b=w.top+w.bottom,A=T-b;r.section==="body"&&(A-=h.getHeadHeight(h.columns)+h.getFootHeight(h.columns));var _=r.getMinimumRowHeight(h.columns,g),j=_<C;if(_>A)return console.error("Will not be able to print row ".concat(r.index," correctly since it's minimum height is larger than page height")),!0;if(!j)return!1;var R=r.hasRowSpan(h.columns),B=r.getMaxCellHeight(h.columns)>A;return B?(R&&console.error("The content of row ".concat(r.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(R||h.settings.rowPageBreak==="avoid")}function S(g,r,C,h,T,w,b){var A=H(g,r,h,w);if(C.canEntireRowFit(A,b))m(g,r,C,w,b);else if(u(g,C,A,r)){var _=a(C,A,r,g);m(g,r,C,w,b),k(g,r,T,w,b),S(g,r,_,h,T,w,b)}else k(g,r,T,w,b),S(g,r,C,h,T,w,b)}function m(g,r,C,h,T){h.x=r.settings.margin.left;for(var w=0,b=T;w<b.length;w++){var A=b[w],_=C.cells[A.index];if(!_){h.x+=A.width;continue}g.applyStyles(_.styles),_.x=h.x,_.y=h.y;var j=r.callCellHooks(g,r.hooks.willDrawCell,_,C,A,h);if(j===!1){h.x+=A.width;continue}p(g,_,h);var R=_.getTextPos();(0,i.default)(_.text,R.x,R.y,{halign:_.styles.halign,valign:_.styles.valign,maxWidth:Math.ceil(_.width-_.padding("left")-_.padding("right"))},g.getDocument()),r.callCellHooks(g,r.hooks.didDrawCell,_,C,A,h),h.x+=A.width}h.y+=C.height}function p(g,r,C){var h=r.styles;if(g.getDocument().setFillColor(g.getDocument().getFillColor()),typeof h.lineWidth=="number"){var T=(0,F.getFillStyle)(h.lineWidth,h.fillColor);T&&g.rect(r.x,C.y,r.width,r.height,T)}else typeof h.lineWidth=="object"&&(h.fillColor&&g.rect(r.x,C.y,r.width,r.height,"F"),s(g,r,C,h.lineWidth))}function s(g,r,C,h){var T,w,b,A;h.top&&(T=C.x,w=C.y,b=C.x+r.width,A=C.y,h.right&&(b+=.5*h.right),h.left&&(T-=.5*h.left),_(h.top,T,w,b,A)),h.bottom&&(T=C.x,w=C.y+r.height,b=C.x+r.width,A=C.y+r.height,h.right&&(b+=.5*h.right),h.left&&(T-=.5*h.left),_(h.bottom,T,w,b,A)),h.left&&(T=C.x,w=C.y,b=C.x,A=C.y+r.height,h.top&&(w-=.5*h.top),h.bottom&&(A+=.5*h.bottom),_(h.left,T,w,b,A)),h.right&&(T=C.x+r.width,w=C.y,b=C.x+r.width,A=C.y+r.height,h.top&&(w-=.5*h.top),h.bottom&&(A+=.5*h.bottom),_(h.right,T,w,b,A));function _(j,R,B,O,Y){g.getDocument().setLineWidth(j),g.getDocument().line(R,B,O,Y,"S")}}function H(g,r,C,h){var T=r.settings.margin.bottom,w=r.settings.showFoot;return(w==="everyPage"||w==="lastPage"&&C)&&(T+=r.getFootHeight(r.columns)),g.pageSize().height-h.y-T}function k(g,r,C,h,T,w){T===void 0&&(T=[]),w===void 0&&(w=!1),g.applyStyles(g.userStyles),r.settings.showFoot==="everyPage"&&!w&&r.foot.forEach(function(A){return m(g,r,A,h,T)}),r.callEndPageHooks(g,h);var b=r.settings.margin;(0,F.addTableBorder)(g,r,C,h),E(g),r.pageNumber++,r.pageCount++,h.x=b.left,h.y=b.top,C.y=b.top,r.callWillDrawPageHooks(g,h),r.settings.showHead==="everyPage"&&(r.head.forEach(function(A){return m(g,r,A,h,T)}),g.applyStyles(g.userStyles))}v.addPage=k;function E(g){var r=g.pageNumber();g.setPage(r+1);var C=g.pageNumber();return C===r?(g.addPage(),!0):!1}},224:function(z,v,W){Object.defineProperty(v,"__esModule",{value:!0}),v.calculateAllColumnsCanFitInPage=void 0;var F=W(420);function D(o,i,P){var y;P===void 0&&(P={});var l=(0,F.getPageAvailableWidth)(o,i),e=new Map,t=[],n=[],f=[];i.settings.horizontalPageBreakRepeat,Array.isArray(i.settings.horizontalPageBreakRepeat)?f=i.settings.horizontalPageBreakRepeat:(typeof i.settings.horizontalPageBreakRepeat=="string"||typeof i.settings.horizontalPageBreakRepeat=="number")&&(f=[i.settings.horizontalPageBreakRepeat]),f.forEach(function(S){var m=i.columns.find(function(p){return p.dataKey===S||p.index===S});m&&!e.has(m.index)&&(e.set(m.index,!0),t.push(m.index),n.push(i.columns[m.index]),l-=m.wrappedWidth)});for(var d=!0,a=(y=P==null?void 0:P.start)!==null&&y!==void 0?y:0;a<i.columns.length;){if(e.has(a)){a++;continue}var u=i.columns[a].wrappedWidth;if(d||l>=u)d=!1,t.push(a),n.push(i.columns[a]),l-=u;else break;a++}return{colIndexes:t,columns:n,lastIndex:a-1}}function c(o,i){for(var P=[],y=0;y<i.columns.length;y++){var l=D(o,i,{start:y});l.columns.length&&(P.push(l),y=l.lastIndex)}return P}v.calculateAllColumnsCanFitInPage=c},324:function(z,v,W){Object.defineProperty(v,"__esModule",{value:!0}),v.ellipsize=v.resizeColumns=v.calculateWidths=void 0;var F=W(420);function D(t,n){c(t,n);var f=[],d=0;n.columns.forEach(function(u){var S=u.getMaxCustomCellWidth(n);S?u.width=S:(u.width=u.wrappedWidth,f.push(u)),d+=u.width});var a=n.getWidth(t.pageSize().width)-d;a&&(a=o(f,a,function(u){return Math.max(u.minReadableWidth,u.minWidth)})),a&&(a=o(f,a,function(u){return u.minWidth})),a=Math.abs(a),!n.settings.horizontalPageBreak&&a>.1/t.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),P(n),y(n,t),i(n)}v.calculateWidths=D;function c(t,n){var f=t.scaleFactor(),d=n.settings.horizontalPageBreak,a=(0,F.getPageAvailableWidth)(t,n);n.allRows().forEach(function(u){for(var S=0,m=n.columns;S<m.length;S++){var p=m[S],s=u.cells[p.index];if(s){var H=n.hooks.didParseCell;n.callCellHooks(t,H,s,u,p,null);var k=s.padding("horizontal");s.contentWidth=(0,F.getStringWidth)(s.text,s.styles,t)+k;var E=(0,F.getStringWidth)(s.text.join(" ").split(/[^\S\u00A0]+/),s.styles,t);if(s.minReadableWidth=E+s.padding("horizontal"),typeof s.styles.cellWidth=="number")s.minWidth=s.styles.cellWidth,s.wrappedWidth=s.styles.cellWidth;else if(s.styles.cellWidth==="wrap"||d===!0)s.contentWidth>a?(s.minWidth=a,s.wrappedWidth=a):(s.minWidth=s.contentWidth,s.wrappedWidth=s.contentWidth);else{var g=10/f;s.minWidth=s.styles.minCellWidth||g,s.wrappedWidth=s.contentWidth,s.minWidth>s.wrappedWidth&&(s.wrappedWidth=s.minWidth)}}}}),n.allRows().forEach(function(u){for(var S=0,m=n.columns;S<m.length;S++){var p=m[S],s=u.cells[p.index];if(s&&s.colSpan===1)p.wrappedWidth=Math.max(p.wrappedWidth,s.wrappedWidth),p.minWidth=Math.max(p.minWidth,s.minWidth),p.minReadableWidth=Math.max(p.minReadableWidth,s.minReadableWidth);else{var H=n.styles.columnStyles[p.dataKey]||n.styles.columnStyles[p.index]||{},k=H.cellWidth||H.minCellWidth;k&&typeof k=="number"&&(p.minWidth=k,p.wrappedWidth=k)}s&&(s.colSpan>1&&!p.minWidth&&(p.minWidth=s.minWidth),s.colSpan>1&&!p.wrappedWidth&&(p.wrappedWidth=s.minWidth))}})}function o(t,n,f){for(var d=n,a=t.reduce(function(g,r){return g+r.wrappedWidth},0),u=0;u<t.length;u++){var S=t[u],m=S.wrappedWidth/a,p=d*m,s=S.width+p,H=f(S),k=s<H?H:s;n-=k-S.width,S.width=k}if(n=Math.round(n*1e10)/1e10,n){var E=t.filter(function(g){return n<0?g.width>f(g):!0});E.length&&(n=o(E,n,f))}return n}v.resizeColumns=o;function i(t){for(var n={},f=1,d=t.allRows(),a=0;a<d.length;a++)for(var u=d[a],S=0,m=t.columns;S<m.length;S++){var p=m[S],s=n[p.index];if(f>1)f--,delete u.cells[p.index];else if(s)s.cell.height+=u.height,f=s.cell.colSpan,delete u.cells[p.index],s.left--,s.left<=1&&delete n[p.index];else{var H=u.cells[p.index];if(!H)continue;if(H.height=u.height,H.rowSpan>1){var k=d.length-a,E=H.rowSpan>k?k:H.rowSpan;n[p.index]={cell:H,left:E,row:u}}}}}function P(t){for(var n=t.allRows(),f=0;f<n.length;f++)for(var d=n[f],a=null,u=0,S=0,m=0;m<t.columns.length;m++){var p=t.columns[m];if(S-=1,S>1&&t.columns[m+1])u+=p.width,delete d.cells[p.index];else if(a){var s=a;delete d.cells[p.index],a=null,s.width=p.width+u}else{var s=d.cells[p.index];if(!s)continue;if(S=s.colSpan,u=0,s.colSpan>1){a=s,u+=p.width;continue}s.width=p.width+u}}}function y(t,n){for(var f={count:0,height:0},d=0,a=t.allRows();d<a.length;d++){for(var u=a[d],S=0,m=t.columns;S<m.length;S++){var p=m[S],s=u.cells[p.index];if(s){n.applyStyles(s.styles,!0);var H=s.width-s.padding("horizontal");if(s.styles.overflow==="linebreak")s.text=n.splitTextToSize(s.text,H+1/n.scaleFactor(),{fontSize:s.styles.fontSize});else if(s.styles.overflow==="ellipsize")s.text=l(s.text,H,s.styles,n,"...");else if(s.styles.overflow==="hidden")s.text=l(s.text,H,s.styles,n,"");else if(typeof s.styles.overflow=="function"){var k=s.styles.overflow(s.text,H);typeof k=="string"?s.text=[k]:s.text=k}s.contentHeight=s.getContentHeight(n.scaleFactor(),n.getLineHeightFactor());var E=s.contentHeight/s.rowSpan;s.rowSpan>1&&f.count*f.height<E*s.rowSpan?f={height:E,count:s.rowSpan}:f&&f.count>0&&f.height>E&&(E=f.height),E>u.height&&(u.height=E)}}f.count--}}function l(t,n,f,d,a){return t.map(function(u){return e(u,n,f,d,a)})}v.ellipsize=l;function e(t,n,f,d,a){var u=1e4*d.scaleFactor();if(n=Math.ceil(n*u)/u,n>=(0,F.getStringWidth)(t,f,d))return t;for(;n<(0,F.getStringWidth)(t+a,f,d)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+a}},964:function(z){if(typeof I>"u"){var v=new Error("Cannot find module 'undefined'");throw v.code="MODULE_NOT_FOUND",v}z.exports=I}},x={};function L(z){var v=x[z];if(v!==void 0)return v.exports;var W=x[z]={exports:{}};return M[z].call(W.exports,W,W.exports,L),W.exports}var U={};return function(){var z=U;Object.defineProperty(z,"__esModule",{value:!0}),z.Cell=z.Column=z.Row=z.Table=z.CellHookData=z.__drawTable=z.__createTable=z.applyPlugin=void 0;var v=L(340),W=L(776),F=L(664),D=L(972),c=L(260);Object.defineProperty(z,"Table",{enumerable:!0,get:function(){return c.Table}});var o=L(172);Object.defineProperty(z,"CellHookData",{enumerable:!0,get:function(){return o.CellHookData}});var i=L(260);Object.defineProperty(z,"Cell",{enumerable:!0,get:function(){return i.Cell}}),Object.defineProperty(z,"Column",{enumerable:!0,get:function(){return i.Column}}),Object.defineProperty(z,"Row",{enumerable:!0,get:function(){return i.Row}});function P(n){(0,v.default)(n)}z.applyPlugin=P;function y(n,f){var d=(0,W.parseInput)(n,f),a=(0,D.createTable)(n,d);(0,F.drawTable)(n,a)}function l(n,f){var d=(0,W.parseInput)(n,f);return(0,D.createTable)(n,d)}z.__createTable=l;function e(n,f){(0,F.drawTable)(n,f)}z.__drawTable=e;try{var t=L(964);t.jsPDF&&(t=t.jsPDF),P(t)}catch{}z.default=y}(),U}()})})(nt);var dt=nt.exports;const q=ot(dt);et.register(...lt);const ht=(N,Q)=>new Promise(I=>{const M=document.createElement("canvas");M.width=1e3,M.height=1e3;const x=M.getContext("2d");if(!x){I("");return}x.fillStyle="#FFFFFF",x.fillRect(0,0,M.width,M.height);const L=G.meta.radarAttributeIds||G.attributes.map(c=>c.id),U=(c,o)=>Z[c]?Q==="es"?Z[c].es.toUpperCase():Z[c].en.toUpperCase():o?Q==="es"?o.nameEs.toUpperCase():o.nameEn.toUpperCase():c.toUpperCase(),z=L.map(c=>{const o=N.find(i=>i.id===c);return U(c,o)}),v=L.map(c=>{const o=N.find(i=>i.id===c);return o?o.score:0}),W=L.map(c=>V(c)),F={id:"custom_white_bg",beforeDraw:c=>{const{ctx:o,width:i,height:P}=c;o.save(),o.fillStyle="#FFFFFF",o.fillRect(0,0,i,P),o.restore()}},D=new et(x,{type:"polarArea",data:{labels:z,datasets:[{data:v,backgroundColor:W,borderWidth:2,borderColor:"#ffffff"}]},options:{responsive:!1,animation:!1,layout:{padding:5},scales:{r:{min:0,max:10,ticks:{stepSize:2,z:1,backdropColor:"white",color:"#8c5e4a",font:{size:24}},grid:{color:"#eaddd7",circular:!0},angleLines:{display:!0,color:"#eaddd7"},pointLabels:{display:!0,centerPointLabels:!0,font:{size:20,family:"sans-serif",weight:"bold"},color:"#4a2e24",padding:10}}},plugins:{legend:{display:!1}}},plugins:[F]});setTimeout(()=>{const c=document.createElement("canvas");c.width=M.width,c.height=M.height;const o=c.getContext("2d");if(o){o.fillStyle="#FFFFFF",o.fillRect(0,0,c.width,c.height),o.drawImage(M,0,0);const i=c.toDataURL("image/jpeg",.9);D.destroy(),I(i)}else{const i=M.toDataURL("image/jpeg",.9);D.destroy(),I(i)}},100)}),St=async(N,Q,I)=>{var U;const M=Array.isArray(N)?N:[N];if(M.length===0)return;const x=new it;for(let z=0;z<M.length;z++){const v=M[z];z>0&&x.addPage();const W=v.language==="es",F=(l,e)=>W?e:l;let D=Q;(!D||M.length>1)&&(D=await ht(v.attributes,v.language)),x.setFontSize(18),x.setTextColor(74,46,36),x.text(F("Cacao of Excellence - Sensory Evaluation","Cacao de Excelencia - Evaluación Sensorial"),14,20);const c=[[F("Evaluator","Evaluador"),v.metadata.evaluator||"-"],[F("Sample Code","Código de Muestra"),v.metadata.sampleCode||"-"],[F("Date","Fecha"),st(v.metadata.date,v.language)||"-"],[F("Time","Hora"),v.metadata.time||"-"],[F("Type","Tipo"),v.metadata.evaluationType==="cacao_mass"?F("Cacao Mass","Masa de Cacao"):F("Chocolate","Chocolate")],[F("Sample Info","Info Muestra"),v.metadata.sampleInfo||"-"]];q(x,{startY:30,body:c,theme:"striped",headStyles:{fillColor:[117,74,41]},styles:{fontSize:10,cellPadding:3},columnStyles:{0:{fontStyle:"bold",cellWidth:50}}});let o=x.lastAutoTable.finalY+10;x.setFontSize(12),x.setTextColor(74,46,36),x.setFont("helvetica","bold"),x.text(`${F("Global Quality Score","Calidad Global")}: ${v.globalQuality}/10`,14,o),o+=7,x.setFontSize(11),x.setFont("helvetica","normal");let i="-";if(v.selectedQualityId){const l=G.qualityAttributes.find(e=>e.id===v.selectedQualityId);l&&(i=W?l.nameEs:l.nameEn)}if(x.text(`${F("Additional Positive Qualities","Cualidades positivas adicionales")}: ${i}`,14,o),o+=10,D){const l=x.internal.pageSize.getWidth(),e=140,t=140,n=(l-e)/2;o+t>270&&(x.addPage(),o=20),x.addImage(D,"JPEG",n,o,e,t),o+=t+10}const P=v.attributes.map(l=>{var n;const e=W?l.nameEs:l.nameEn,t=(n=l.subAttributes)==null?void 0:n.filter(f=>f.score>0).map(f=>`${W?f.nameEs:f.nameEn}: ${f.score}`).join(", ");return[e,l.score.toString(),t||""]});q(x,{startY:o,head:[[F("Attribute","Atributo"),{content:F("Score","Puntaje"),styles:{halign:"center"}},F("Descriptors","Descriptores")]],body:P,theme:"grid",headStyles:{fillColor:[117,74,41]},columnStyles:{0:{fontStyle:"bold",cellWidth:50},1:{halign:"center",cellWidth:25}},styles:{fontSize:9}}),o=x.lastAutoTable.finalY+10;const y=(l,e)=>{if(!e)return;o>260&&(x.addPage(),o=20),x.setFontSize(11),x.setFont("helvetica","bold"),x.setTextColor(0,0,0),x.text(l,14,o),o+=6,x.setFontSize(10),x.setFont("helvetica","normal");const t=x.splitTextToSize(e,180);x.text(t,14,o),o+=t.length*5+8};if(y(F("Judge's Notes","Notas del Juez"),v.metadata.notes),y(F("Producer Recommendations","Recomendaciones al Productor"),v.metadata.producerRecommendations),v.tdsProfile&&((U=v.tdsProfile.events)==null?void 0:U.length)>0){o>230&&(x.addPage(),o=20),o+=10,x.setFontSize(14),x.setFont("helvetica","bold"),x.setTextColor(74,46,36),x.text(F("TDS Analysis","Análisis TDS"),14,o),o+=8;const l=v.tdsProfile;let e=v.tdsProfile.analysis;if(!e)try{e=tt(l)}catch(h){console.error("TDS Analysis failed for PDF",h)}x.setFontSize(10),x.setFont("helvetica","normal"),x.setTextColor(0,0,0);const t=F("Total Duration","Duración Total"),n=F("Swallow","Tragado"),f=F("Mode","Modo"),d=l.mode==="expert"?W?"Experto":"Expert":"Normal",a=l.swallowTime;if(x.text(`${t}: ${l.totalDuration.toFixed(1)}s`,14,o),x.text(`${n}: ${a.toFixed(1)}s`,80,o),x.text(`${f}: ${d}`,150,o),o+=6,e){const h=e.firstOnset||0,T=l.totalDuration-a,w=F("First Flavor Onset","Primer Sabor"),b=F("Aftertaste Duration","Duración Post-gusto");x.text(`${w}: ${h.toFixed(1)}s`,14,o),x.text(`${b}: ${T.toFixed(1)}s`,80,o)}o+=12;const u=14,S=180,m=20,p=S/(l.totalDuration||1),s=(e==null?void 0:e.firstOnset)||0,H=s+((e==null?void 0:e.attackPhaseDuration)||0),k=a,E=l.totalDuration,g=u+s*p,r=u+H*p,C=u+k*p;if(x.setFontSize(7),x.setTextColor(80),x.text("0%",g,o-6,{align:"center"}),x.text("20%",r,o-6,{align:"center"}),x.setFont("helvetica","bold"),x.text("100%",C,o-6,{align:"center"}),x.setFont("helvetica","normal"),x.setDrawColor(200),x.setFillColor(245,245,245),x.rect(u,o,S,m,"FD"),l.events.forEach(h=>{const T=u+h.start*p,w=(h.end-h.start)*p;if(w<.2)return;const b=V(h.attrId);x.setFillColor(b),x.rect(T,o,w,m,"F")}),e&&e.attackPhaseDuration>0&&(x.setDrawColor(100),x.setLineWidth(.5),x.setLineDashPattern([1,1],0),x.line(r,o-2,r,o+m+2),x.setLineDashPattern([],0)),k>0&&(x.setDrawColor(0),x.setLineWidth(.8),x.line(C,o-2,C,o+m+2)),o+=m,x.setFontSize(7),x.setTextColor(80),x.text(`${s.toFixed(1)}s`,g,o+5,{align:"center"}),x.text(`${H.toFixed(1)}s`,r,o+5,{align:"center"}),x.setFont("helvetica","bold"),x.text(`${k.toFixed(1)}s`,C,o+5,{align:"center"}),x.setFont("helvetica","normal"),x.text(`${E.toFixed(1)}s`,u+S,o+5,{align:"right"}),o+=15,e&&e.scores){o+=5;const h=G.attributes.map(T=>{const w=T.id;let b;e&&e.scores&&(e.scores instanceof Map?b=e.scores.get(w):b=e.scores[w]);const A=b?b.score:0,_=b?b.durationPercent:0,j=W?T.nameEs:T.nameEn,B=b&&b.originalScore!==void 0&&b.originalScore<b.score?`${A} (*)`:A.toString();return["",j,`${_.toFixed(1)}%`,B]});if(q(x,{startY:o,head:[["",F("TDS Attribute","Atributo TDS"),{content:F("Dominance %","Dominancia %"),styles:{halign:"center"}},{content:F("CoEx Score","Puntaje CoEx"),styles:{halign:"center"}}]],body:h,theme:"grid",headStyles:{fillColor:[150,150,150],textColor:255},styles:{fontSize:8,cellPadding:2},columnStyles:{0:{cellWidth:8},1:{cellWidth:80},2:{halign:"center"},3:{halign:"center",fontStyle:"bold"}},margin:{left:14,right:14},didDrawCell:T=>{if(T.section==="body"&&T.column.index===0){const w=T.row.index;if(w<G.attributes.length){const b=G.attributes[w].id,A=V(b),_=4,j=T.cell.x+(T.cell.width-_)/2,R=T.cell.y+(T.cell.height-_)/2;x.setFillColor(A),x.rect(j,R,_,_,"F")}}}}),o=x.lastAutoTable.finalY+10,v.tdsProfile&&(!e||e.aromaPercent===void 0||e.aftertastePercent===void 0||e.kickSuggestions&&e.kickSuggestions.some(w=>typeof w=="string")||e.qualitySuggestions&&e.qualitySuggestions.some(w=>typeof w=="string"))&&(console.log(`[PDF] Recalculating analysis for sample ${z+1} due to missing fields or legacy format.`),e=tt({mode:v.tdsProfile.mode,id:"temp-recalc",events:v.tdsProfile.events,swallowTime:v.tdsProfile.swallowTime,totalDuration:v.tdsProfile.totalDuration})),e&&e.aromaNotes.length>0){const w=e.aromaNotes.map(b=>{const A=v.attributes.find(_=>_.id===b)||v.attributes.flatMap(_=>_.subAttributes||[]).find(_=>_.id===b);return A?W?A.nameEs:A.nameEn:b}).join(", ");if(w){const b=F(`Dominant Aromas (${e.aromaPercent}%)`,`Aromas Dominantes (${e.aromaPercent}%)`);y(b,w)}}if(e){const T=(w,b)=>{const A=G.attributes.find(_=>_.id===w);return A?b==="es"?A.nameEs:A.nameEn:w};if(e.dominantAftertaste){const w=T(e.dominantAftertaste,W?"es":"en"),b=F(`Dominant Aftertaste (${e.aftertastePercent}%)`,`Post-gusto Dominante (${e.aftertastePercent}%)`);y(b,w)}if(e.aftertasteBoosts&&e.aftertasteBoosts.length>0){const w=e.aftertasteBoosts.map(b=>`${T(b.attrId,W?"es":"en")} +${b.amount}`).join(", ");y(F("Aftertaste Boosts","Refuerzos de Post-gusto"),w)}if(e.qualityModifier!==0){const w=e.qualityModifier>0?"+":"";y(F("Suggested Global Quality Adjustment","Ajuste de Calidad Global Sugerido"),`${w}${e.qualityModifier}`)}if(e.kickSuggestions&&e.kickSuggestions.length>0){const w=e.kickSuggestions.map(b=>typeof b=="string"?b:b[W?"es":"en"]).join(`
`);y(F("Initial Kick Insights","Observaciones del Impacto Inicial"),w)}if(e.qualitySuggestions&&e.qualitySuggestions.length>0){const w=e.qualitySuggestions.map(b=>typeof b=="string"?b:b[W?"es":"en"]).join(`
`);y(F("Aftertaste Quality Insights","Observaciones de Calidad del Post-gusto"),w)}}}}x.setFontSize(8),x.setTextColor(150),x.text(`${F("Sample","Muestra")} ${z+1} / ${M.length}`,14,290,{align:"left"})}let L=I;if(!L){const z=ft();L=M.length===1?`CoEx_${M[0].metadata.sampleCode||"Report"}.pdf`:`CoEx_Bulk_Report_${z}.pdf`}L.toLowerCase().endsWith(".pdf")||(L+=".pdf"),x.save(L)};export{St as generatePdf};
