import{I as u,e as p,b as v}from"./index-BszND5xp.js";const f=c=>{try{return JSON.parse(c)}catch{return[]}},T=(c,d)=>v.csv.getRow(c,d),I=(c,d)=>{const s=(e,a,i)=>{if(e[a]!==void 0)return e[a];if(e[i]!==void 0)return e[i];const r=Object.keys(e).find(o=>o.trim()===a||o.trim()===i);return r?e[r]:""},l=(e,a,i)=>{const r=s(e,a,i),o=parseFloat(r);return isNaN(o)?0:o},m=JSON.stringify(u);return c.map(e=>{const a={sampleCode:s(e,"CoEx Sample Code","ID de muestra")||"Unknown",date:s(e,"Date Eval (press Ctrl and ;)","Fecha de evaluación"),time:s(e,"Time Eval (press Ctrl and :)","Hora de evaluación"),evaluator:s(e,"Panelist Initials","Evaluador"),evaluationType:"cacao_mass",sampleInfo:s(e,"Sample Information","Información de muestra"),notes:s(e,"Overall Flavour comment","Comentario de sabor general"),producerRecommendations:s(e,"Feedback comment","Comentarios de comentarios"),globalQuality:l(e,"Global Quality (0 - 10)","Calidad global (0 - 10)"),language:d,selectedQualityId:void 0,attributes:JSON.parse(m)};if(a.date&&a.date.includes("/")){const t=a.date.split("/");t.length===3&&(a.date=`${t[2]}-${t[1]}-${t[0]}`)}a.attributes.forEach(t=>{t.score=l(e,t.csvHeaderEn,t.csvHeaderEs),t.subAttributes&&t.subAttributes.forEach(n=>{n.score=l(e,n.csvHeaderEn,n.csvHeaderEs),n.id==="def_other"&&(n.description=s(e,"Other Off-Flavour Description","Descripción"))})});let i=0,r;p.forEach(t=>{const n=l(e,t.csvHeaderEn,t.csvHeaderEs);n>i&&(i=n,r=t.id)}),i>0&&(a.selectedQualityId=r);const o=s(e,"TDS Mode","Modo TDS");if(o&&(o==="normal"||o==="expert")){const t=s(e,"TDS Events JSON","Eventos TDS JSON"),n=f(t);n.length>0&&(a.tdsProfile={id:crypto.randomUUID(),mode:o,totalDuration:l(e,"TDS Total Duration (s)","Duración Total TDS (s)"),swallowTime:l(e,"TDS Swallow Time (s)","Tiempo de Tragado TDS (s)"),events:n})}return a}).filter(e=>e.sampleCode&&e.sampleCode!=="Unknown")};export{T as generateCSVRow,I as parseSamplesFromCSV};
