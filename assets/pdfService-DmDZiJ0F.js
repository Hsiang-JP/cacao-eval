import{j as at,E as rt}from"./jspdf.es.min-DntnpIfp.js";import{k as it,g as ot,f as J,a as $}from"./index-Dw65S7rK.js";import{A as X}from"./attributes-zDdy4c7G.js";import{C as et,r as st}from"./index-rBm6tBrN.js";import{g as V}from"./colors-C8jCGJn0.js";import{a as tt}from"./tdsCalculator-D11FdiJf.js";import{f as lt,b as ft}from"./dateUtils-BSM0ms4X.js";import"./createLucideIcon-D7ZCby8C.js";var nt={exports:{}};const dt=it(at);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(U,Q){(function(L,D){U.exports=D(function(){try{return dt}catch{}}())})(typeof globalThis<"u"?globalThis:typeof J<"u"?J:typeof window<"u"?window:typeof self<"u"?self:J,function(N){return function(){var L={172:function(E,S){var b=this&&this.__extends||function(){var u=function(w,e){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,m){C.__proto__=m}||function(C,m){for(var d in m)Object.prototype.hasOwnProperty.call(m,d)&&(C[d]=m[d])},u(w,e)};return function(w,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");u(w,e);function C(){this.constructor=w}w.prototype=e===null?Object.create(e):(C.prototype=e.prototype,new C)}}();Object.defineProperty(S,"__esModule",{value:!0}),S.CellHookData=S.HookData=void 0;var R=function(){function u(w,e,C){this.table=e,this.pageNumber=e.pageNumber,this.pageCount=this.pageNumber,this.settings=e.settings,this.cursor=C,this.doc=w.getDocument()}return u}();S.HookData=R;var v=function(u){b(w,u);function w(e,C,m,d,a,t){var n=u.call(this,e,C,t)||this;return n.cell=m,n.row=d,n.column=a,n.section=d.section,n}return w}(R);S.CellHookData=v},340:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0});var R=b(4),v=b(136),u=b(744),w=b(776),e=b(664),C=b(972);function m(d){d.API.autoTable=function(){for(var a=[],t=0;t<arguments.length;t++)a[t]=arguments[t];var n;a.length===1?n=a[0]:(console.error("Use of deprecated autoTable initiation"),n=a[2]||{},n.columns=a[0],n.body=a[1]);var s=(0,w.parseInput)(this,n),l=(0,C.createTable)(this,s);return(0,e.drawTable)(this,l),this},d.API.lastAutoTable=!1,d.API.previousAutoTable=!1,d.API.autoTable.previous=!1,d.API.autoTableText=function(a,t,n,s){(0,v.default)(a,t,n,s,this)},d.API.autoTableSetDefaults=function(a){return u.DocHandler.setDefaults(a,this),this},d.autoTableSetDefaults=function(a,t){u.DocHandler.setDefaults(a,t)},d.API.autoTableHtmlToJson=function(a,t){var n;if(t===void 0&&(t=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var s=new u.DocHandler(this),l=(0,R.parseHtml)(s,a,window,t,!1),r=l.head,f=l.body,p=((n=r[0])===null||n===void 0?void 0:n.map(function(y){return y.content}))||[];return{columns:p,rows:f,data:f}},d.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var a=this.lastAutoTable;return a&&a.finalY?a.finalY:0},d.API.autoTableAddPageContent=function(a){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),d.API.autoTable.globalDefaults||(d.API.autoTable.globalDefaults={}),d.API.autoTable.globalDefaults.addPageContent=a,this},d.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}S.default=m},136:function(E,S){Object.defineProperty(S,"__esModule",{value:!0});function b(R,v,u,w,e){w=w||{};var C=1.15,m=e.internal.scaleFactor,d=e.internal.getFontSize()/m,a=e.getLineHeightFactor?e.getLineHeightFactor():C,t=d*a,n=/\r\n|\r|\n/g,s="",l=1;if((w.valign==="middle"||w.valign==="bottom"||w.halign==="center"||w.halign==="right")&&(s=typeof R=="string"?R.split(n):R,l=s.length||1),u+=d*(2-C),w.valign==="middle"?u-=l/2*t:w.valign==="bottom"&&(u-=l*t),w.halign==="center"||w.halign==="right"){var r=d;if(w.halign==="center"&&(r*=.5),s&&l>=1){for(var f=0;f<s.length;f++)e.text(s[f],v-e.getStringUnitWidth(s[f])*r,u),u+=t;return e}v-=e.getStringUnitWidth(R)*r}return w.halign==="justify"?e.text(R,v,u,{maxWidth:w.maxWidth||100,align:"justify"}):e.text(R,v,u),e}S.default=b},420:function(E,S){Object.defineProperty(S,"__esModule",{value:!0}),S.getPageAvailableWidth=S.parseSpacing=S.getFillStyle=S.addTableBorder=S.getStringWidth=void 0;function b(e,C,m){m.applyStyles(C,!0);var d=Array.isArray(e)?e:[e],a=d.map(function(t){return m.getTextWidth(t)}).reduce(function(t,n){return Math.max(t,n)},0);return a}S.getStringWidth=b;function R(e,C,m,d){var a=C.settings.tableLineWidth,t=C.settings.tableLineColor;e.applyStyles({lineWidth:a,lineColor:t});var n=v(a,!1);n&&e.rect(m.x,m.y,C.getWidth(e.pageSize().width),d.y-m.y,n)}S.addTableBorder=R;function v(e,C){var m=e>0,d=C||C===0;return m&&d?"DF":m?"S":d?"F":null}S.getFillStyle=v;function u(e,C){var m,d,a,t;if(e=e||C,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=C}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(m=e.left)!==null&&m!==void 0?m:C,top:(d=e.top)!==null&&d!==void 0?d:C,right:(a=e.right)!==null&&a!==void 0?a:C,bottom:(t=e.bottom)!==null&&t!==void 0?t:C}):(typeof e!="number"&&(e=C),{top:e,right:e,bottom:e,left:e})}S.parseSpacing=u;function w(e,C){var m=u(C.settings.margin,0);return e.pageSize().width-(m.left+m.right)}S.getPageAvailableWidth=w},796:function(E,S){var b=this&&this.__extends||function(){var w=function(e,C){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,d){m.__proto__=d}||function(m,d){for(var a in d)Object.prototype.hasOwnProperty.call(d,a)&&(m[a]=d[a])},w(e,C)};return function(e,C){if(typeof C!="function"&&C!==null)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");w(e,C);function m(){this.constructor=e}e.prototype=C===null?Object.create(C):(m.prototype=C.prototype,new m)}}();Object.defineProperty(S,"__esModule",{value:!0}),S.getTheme=S.defaultStyles=S.HtmlRowInput=void 0;var R=function(w){b(e,w);function e(C){var m=w.call(this)||this;return m._element=C,m}return e}(Array);S.HtmlRowInput=R;function v(w){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/w,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}S.defaultStyles=v;function u(w){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[w]}S.getTheme=u},903:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.parseCss=void 0;var R=b(420);function v(m,d,a,t,n){var s={},l=1.3333333333333333,r=w(d,function(g){return n.getComputedStyle(g).backgroundColor});r!=null&&(s.fillColor=r);var f=w(d,function(g){return n.getComputedStyle(g).color});f!=null&&(s.textColor=f);var p=C(t,a);p&&(s.cellPadding=p);var y="borderTopColor",c=l*a,o=t.borderTopWidth;if(t.borderBottomWidth===o&&t.borderRightWidth===o&&t.borderLeftWidth===o){var F=(parseFloat(o)||0)/c;F&&(s.lineWidth=F)}else s.lineWidth={top:(parseFloat(t.borderTopWidth)||0)/c,right:(parseFloat(t.borderRightWidth)||0)/c,bottom:(parseFloat(t.borderBottomWidth)||0)/c,left:(parseFloat(t.borderLeftWidth)||0)/c},s.lineWidth.top||(s.lineWidth.right?y="borderRightColor":s.lineWidth.bottom?y="borderBottomColor":s.lineWidth.left&&(y="borderLeftColor"));var z=w(d,function(g){return n.getComputedStyle(g)[y]});z!=null&&(s.lineColor=z);var j=["left","right","center","justify"];j.indexOf(t.textAlign)!==-1&&(s.halign=t.textAlign),j=["middle","bottom","top"],j.indexOf(t.verticalAlign)!==-1&&(s.valign=t.verticalAlign);var h=parseInt(t.fontSize||"");isNaN(h)||(s.fontSize=h/l);var i=u(t);i&&(s.fontStyle=i);var P=(t.fontFamily||"").toLowerCase();return m.indexOf(P)!==-1&&(s.font=P),s}S.parseCss=v;function u(m){var d="";return(m.fontWeight==="bold"||m.fontWeight==="bolder"||parseInt(m.fontWeight)>=700)&&(d="bold"),(m.fontStyle==="italic"||m.fontStyle==="oblique")&&(d+="italic"),d}function w(m,d){var a=e(m,d);if(!a)return null;var t=a.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!t||!Array.isArray(t))return null;var n=[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])],s=parseInt(t[4]);return s===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function e(m,d){var a=d(m);return a==="rgba(0, 0, 0, 0)"||a==="transparent"||a==="initial"||a==="inherit"?m.parentElement==null?null:e(m.parentElement,d):a}function C(m,d){var a=[m.paddingTop,m.paddingRight,m.paddingBottom,m.paddingLeft],t=96/(72/d),n=(parseInt(m.lineHeight)-parseInt(m.fontSize))/d/2,s=a.map(function(r){return parseInt(r||"0")/t}),l=(0,R.parseSpacing)(s,0);return n>l.top&&(l.top=n),n>l.bottom&&(l.bottom=n),l}},744:function(E,S){Object.defineProperty(S,"__esModule",{value:!0}),S.DocHandler=void 0;var b={},R=function(){function v(u){this.jsPDFDocument=u,this.userStyles={textColor:u.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:u.internal.getFontSize(),fontStyle:u.internal.getFont().fontStyle,font:u.internal.getFont().fontName,lineWidth:u.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:u.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return v.setDefaults=function(u,w){w===void 0&&(w=null),w?w.__autoTableDocumentDefaults=u:b=u},v.unifyColor=function(u){return Array.isArray(u)?u:typeof u=="number"?[u,u,u]:typeof u=="string"?[u]:null},v.prototype.applyStyles=function(u,w){var e,C,m;w===void 0&&(w=!1),u.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(u.fontStyle);var d=this.jsPDFDocument.internal.getFont(),a=d.fontStyle,t=d.fontName;if(u.font&&(t=u.font),u.fontStyle){a=u.fontStyle;var n=this.getFontList()[t];n&&n.indexOf(a)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(n[0]),a=n[0])}if(this.jsPDFDocument.setFont(t,a),u.fontSize&&this.jsPDFDocument.setFontSize(u.fontSize),!w){var s=v.unifyColor(u.fillColor);s&&(e=this.jsPDFDocument).setFillColor.apply(e,s),s=v.unifyColor(u.textColor),s&&(C=this.jsPDFDocument).setTextColor.apply(C,s),s=v.unifyColor(u.lineColor),s&&(m=this.jsPDFDocument).setDrawColor.apply(m,s),typeof u.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(u.lineWidth)}},v.prototype.splitTextToSize=function(u,w,e){return this.jsPDFDocument.splitTextToSize(u,w,e)},v.prototype.rect=function(u,w,e,C,m){return this.jsPDFDocument.rect(u,w,e,C,m)},v.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},v.prototype.getTextWidth=function(u){return this.jsPDFDocument.getTextWidth(u)},v.prototype.getDocument=function(){return this.jsPDFDocument},v.prototype.setPage=function(u){this.jsPDFDocument.setPage(u)},v.prototype.addPage=function(){return this.jsPDFDocument.addPage()},v.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},v.prototype.getGlobalOptions=function(){return b||{}},v.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},v.prototype.pageSize=function(){var u=this.jsPDFDocument.internal.pageSize;return u.width==null&&(u={width:u.getWidth(),height:u.getHeight()}),u},v.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},v.prototype.getLineHeightFactor=function(){var u=this.jsPDFDocument;return u.getLineHeightFactor?u.getLineHeightFactor():1.15},v.prototype.getLineHeight=function(u){return u/this.scaleFactor()*this.getLineHeightFactor()},v.prototype.pageNumber=function(){var u=this.jsPDFDocument.internal.getCurrentPageInfo();return u?u.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},v}();S.DocHandler=R},4:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.parseHtml=void 0;var R=b(903),v=b(796);function u(C,m,d,a,t){var n,s;a===void 0&&(a=!1),t===void 0&&(t=!1);var l;typeof m=="string"?l=d.document.querySelector(m):l=m;var r=Object.keys(C.getFontList()),f=C.scaleFactor(),p=[],y=[],c=[];if(!l)return console.error("Html table could not be found with input: ",m),{head:p,body:y,foot:c};for(var o=0;o<l.rows.length;o++){var F=l.rows[o],z=(s=(n=F==null?void 0:F.parentElement)===null||n===void 0?void 0:n.tagName)===null||s===void 0?void 0:s.toLowerCase(),j=w(r,f,d,F,a,t);j&&(z==="thead"?p.push(j):z==="tfoot"?c.push(j):y.push(j))}return{head:p,body:y,foot:c}}S.parseHtml=u;function w(C,m,d,a,t,n){for(var s=new v.HtmlRowInput(a),l=0;l<a.cells.length;l++){var r=a.cells[l],f=d.getComputedStyle(r);if(t||f.display!=="none"){var p=void 0;n&&(p=(0,R.parseCss)(C,r,m,f,d)),s.push({rowSpan:r.rowSpan,colSpan:r.colSpan,styles:p,_element:r,content:e(r)})}}var y=d.getComputedStyle(a);if(s.length>0&&(t||y.display!=="none"))return s}function e(C){var m=C.cloneNode(!0);return m.innerHTML=m.innerHTML.replace(/\n/g,"").replace(/ +/g," "),m.innerHTML=m.innerHTML.split(/<br.*?>/).map(function(d){return d.trim()}).join(`
`),m.innerText||m.textContent||""}},776:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.parseInput=void 0;var R=b(4),v=b(356),u=b(420),w=b(744),e=b(792);function C(l,r){var f=new w.DocHandler(l),p=f.getDocumentOptions(),y=f.getGlobalOptions();(0,e.default)(f,y,p,r);var c=(0,v.assign)({},y,p,r),o;typeof window<"u"&&(o=window);var F=m(y,p,r),z=d(y,p,r),j=a(f,c),h=n(f,c,o);return{id:r.tableId,content:h,hooks:z,styles:F,settings:j}}S.parseInput=C;function m(l,r,f){for(var p={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},y=function(z){if(z==="columnStyles"){var j=l[z],h=r[z],i=f[z];p.columnStyles=(0,v.assign)({},j,h,i)}else{var P=[l,r,f],g=P.map(function(x){return x[z]||{}});p[z]=(0,v.assign)({},g[0],g[1],g[2])}},c=0,o=Object.keys(p);c<o.length;c++){var F=o[c];y(F)}return p}function d(l,r,f){for(var p=[l,r,f],y={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},c=0,o=p;c<o.length;c++){var F=o[c];F.didParseCell&&y.didParseCell.push(F.didParseCell),F.willDrawCell&&y.willDrawCell.push(F.willDrawCell),F.didDrawCell&&y.didDrawCell.push(F.didDrawCell),F.willDrawPage&&y.willDrawPage.push(F.willDrawPage),F.didDrawPage&&y.didDrawPage.push(F.didDrawPage)}return y}function a(l,r){var f,p,y,c,o,F,z,j,h,i,P,g,x=(0,u.parseSpacing)(r.margin,40/l.scaleFactor()),H=(f=t(l,r.startY))!==null&&f!==void 0?f:x.top,k;r.showFoot===!0?k="everyPage":r.showFoot===!1?k="never":k=(p=r.showFoot)!==null&&p!==void 0?p:"everyPage";var T;r.showHead===!0?T="everyPage":r.showHead===!1?T="never":T=(y=r.showHead)!==null&&y!==void 0?y:"everyPage";var W=(c=r.useCss)!==null&&c!==void 0?c:!1,A=r.theme||(W?"plain":"striped"),_=!!r.horizontalPageBreak,M=(o=r.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(F=r.includeHiddenHtml)!==null&&F!==void 0?F:!1,useCss:W,theme:A,startY:H,margin:x,pageBreak:(z=r.pageBreak)!==null&&z!==void 0?z:"auto",rowPageBreak:(j=r.rowPageBreak)!==null&&j!==void 0?j:"auto",tableWidth:(h=r.tableWidth)!==null&&h!==void 0?h:"auto",showHead:T,showFoot:k,tableLineWidth:(i=r.tableLineWidth)!==null&&i!==void 0?i:0,tableLineColor:(P=r.tableLineColor)!==null&&P!==void 0?P:200,horizontalPageBreak:_,horizontalPageBreakRepeat:M,horizontalPageBreakBehaviour:(g=r.horizontalPageBreakBehaviour)!==null&&g!==void 0?g:"afterAllRows"}}function t(l,r){var f=l.getLastAutoTable(),p=l.scaleFactor(),y=l.pageNumber(),c=!1;if(f&&f.startPageNumber){var o=f.startPageNumber+f.pageNumber-1;c=o===y}return typeof r=="number"?r:(r==null||r===!1)&&c&&(f==null?void 0:f.finalY)!=null?f.finalY+20/p:null}function n(l,r,f){var p=r.head||[],y=r.body||[],c=r.foot||[];if(r.html){var o=r.includeHiddenHtml;if(f){var F=(0,R.parseHtml)(l,r.html,f,o,r.useCss)||{};p=F.head||p,y=F.body||p,c=F.foot||p}else console.error("Cannot parse html in non browser environment")}var z=r.columns||s(p,y,c);return{columns:z,head:p,body:y,foot:c}}function s(l,r,f){var p=l[0]||r[0]||f[0]||[],y=[];return Object.keys(p).filter(function(c){return c!=="_element"}).forEach(function(c){var o=1,F;Array.isArray(p)?F=p[parseInt(c)]:F=p[c],typeof F=="object"&&!Array.isArray(F)&&(o=(F==null?void 0:F.colSpan)||1);for(var z=0;z<o;z++){var j=void 0;Array.isArray(p)?j=y.length:j=c+(z>0?"_".concat(z):"");var h={dataKey:j};y.push(h)}}),y}},792:function(E,S){Object.defineProperty(S,"__esModule",{value:!0});function b(v,u,w,e){for(var C=function(t){t&&typeof t!="object"&&console.error("The options parameter should be of type object, is: "+typeof t),typeof t.extendWidth<"u"&&(t.tableWidth=t.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof t.margins<"u"&&(typeof t.margin>"u"&&(t.margin=t.margins),console.error("Use of deprecated option: margins, use margin instead.")),t.startY&&typeof t.startY!="number"&&(console.error("Invalid value for startY option",t.startY),delete t.startY),!t.didDrawPage&&(t.afterPageContent||t.beforePageContent||t.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),t.didDrawPage=function(c){v.applyStyles(v.userStyles),t.beforePageContent&&t.beforePageContent(c),v.applyStyles(v.userStyles),t.afterPageContent&&t.afterPageContent(c),v.applyStyles(v.userStyles),t.afterPageAdd&&c.pageNumber>1&&c.afterPageAdd(c),v.applyStyles(v.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(c){t[c]&&console.error('The "'.concat(c,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(c){var o=c[0],F=c[1];t[F]&&(console.error("Use of deprecated option ".concat(F,". Use ").concat(o," instead")),t[o]=t[F])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(c){var o=typeof c=="string"?c:c[0],F=typeof c=="string"?c:c[1];typeof t[o]<"u"&&(typeof t.styles[F]>"u"&&(t.styles[F]=t[o]),console.error("Use of deprecated option: "+o+", use the style "+F+" instead."))});for(var n=0,s=["styles","bodyStyles","headStyles","footStyles"];n<s.length;n++){var l=s[n];R(t[l]||{})}for(var r=t.columnStyles||{},f=0,p=Object.keys(r);f<p.length;f++){var y=p[f];R(r[y]||{})}},m=0,d=[u,w,e];m<d.length;m++){var a=d[m];C(a)}}S.default=b;function R(v){v.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),v.minCellHeight||(v.minCellHeight=v.rowHeight)):v.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),v.cellWidth||(v.cellWidth=v.columnWidth))}},260:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.Column=S.Cell=S.Row=S.Table=void 0;var R=b(796),v=b(172),u=b(420),w=function(){function d(a,t){this.pageNumber=1,this.pageCount=1,this.id=a.id,this.settings=a.settings,this.styles=a.styles,this.hooks=a.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return d.prototype.getHeadHeight=function(a){return this.head.reduce(function(t,n){return t+n.getMaxCellHeight(a)},0)},d.prototype.getFootHeight=function(a){return this.foot.reduce(function(t,n){return t+n.getMaxCellHeight(a)},0)},d.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},d.prototype.callCellHooks=function(a,t,n,s,l,r){for(var f=0,p=t;f<p.length;f++){var y=p[f],c=new v.CellHookData(a,this,n,s,l,r),o=y(c)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],o)return!1}return!0},d.prototype.callEndPageHooks=function(a,t){a.applyStyles(a.userStyles);for(var n=0,s=this.hooks.didDrawPage;n<s.length;n++){var l=s[n];l(new v.HookData(a,this,t))}},d.prototype.callWillDrawPageHooks=function(a,t){for(var n=0,s=this.hooks.willDrawPage;n<s.length;n++){var l=s[n];l(new v.HookData(a,this,t))}},d.prototype.getWidth=function(a){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var t=this.columns.reduce(function(s,l){return s+l.wrappedWidth},0);return t}else{var n=this.settings.margin;return a-n.left-n.right}},d}();S.Table=w;var e=function(){function d(a,t,n,s,l){l===void 0&&(l=!1),this.height=0,this.raw=a,a instanceof R.HtmlRowInput&&(this.raw=a._element,this.element=a._element),this.index=t,this.section=n,this.cells=s,this.spansMultiplePages=l}return d.prototype.getMaxCellHeight=function(a){var t=this;return a.reduce(function(n,s){var l;return Math.max(n,((l=t.cells[s.index])===null||l===void 0?void 0:l.height)||0)},0)},d.prototype.hasRowSpan=function(a){var t=this;return a.filter(function(n){var s=t.cells[n.index];return s?s.rowSpan>1:!1}).length>0},d.prototype.canEntireRowFit=function(a,t){return this.getMaxCellHeight(t)<=a},d.prototype.getMinimumRowHeight=function(a,t){var n=this;return a.reduce(function(s,l){var r=n.cells[l.index];if(!r)return 0;var f=t.getLineHeight(r.styles.fontSize),p=r.padding("vertical"),y=p+f;return y>s?y:s},0)},d}();S.Row=e;var C=function(){function d(a,t,n){var s,l;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=n,this.raw=a;var r=a;a!=null&&typeof a=="object"&&!Array.isArray(a)?(this.rowSpan=a.rowSpan||1,this.colSpan=a.colSpan||1,r=(l=(s=a.content)!==null&&s!==void 0?s:a.title)!==null&&l!==void 0?l:a,a._element&&(this.raw=a._element)):(this.rowSpan=1,this.colSpan=1);var f=r!=null?""+r:"",p=/\r\n|\r|\n/g;this.text=f.split(p)}return d.prototype.getTextPos=function(){var a;if(this.styles.valign==="top")a=this.y+this.padding("top");else if(this.styles.valign==="bottom")a=this.y+this.height-this.padding("bottom");else{var t=this.height-this.padding("vertical");a=this.y+t/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var s=this.width-this.padding("horizontal");n=this.x+s/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:a}},d.prototype.getContentHeight=function(a,t){t===void 0&&(t=1.15);var n=Array.isArray(this.text)?this.text.length:1,s=this.styles.fontSize/a*t,l=n*s+this.padding("vertical");return Math.max(l,this.styles.minCellHeight)},d.prototype.padding=function(a){var t=(0,u.parseSpacing)(this.styles.cellPadding,0);return a==="vertical"?t.top+t.bottom:a==="horizontal"?t.left+t.right:t[a]},d}();S.Cell=C;var m=function(){function d(a,t,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=a,this.raw=t,this.index=n}return d.prototype.getMaxCustomCellWidth=function(a){for(var t=0,n=0,s=a.allRows();n<s.length;n++){var l=s[n],r=l.cells[this.index];r&&typeof r.styles.cellWidth=="number"&&(t=Math.max(t,r.styles.cellWidth))}return t},d}();S.Column=m},356:function(E,S){Object.defineProperty(S,"__esModule",{value:!0}),S.assign=void 0;function b(R,v,u,w,e){if(R==null)throw new TypeError("Cannot convert undefined or null to object");for(var C=Object(R),m=1;m<arguments.length;m++){var d=arguments[m];if(d!=null)for(var a in d)Object.prototype.hasOwnProperty.call(d,a)&&(C[a]=d[a])}return C}S.assign=b},972:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.createTable=void 0;var R=b(744),v=b(260),u=b(324),w=b(796),e=b(356);function C(l,r){var f=new R.DocHandler(l),p=m(r,f.scaleFactor()),y=new v.Table(r,p);return(0,u.calculateWidths)(f,y),f.applyStyles(f.userStyles),y}S.createTable=C;function m(l,r){var f=l.content,p=n(f.columns);if(f.head.length===0){var y=a(p,"head");y&&f.head.push(y)}if(f.foot.length===0){var y=a(p,"foot");y&&f.foot.push(y)}var c=l.settings.theme,o=l.styles;return{columns:p,head:d("head",f.head,p,o,c,r),body:d("body",f.body,p,o,c,r),foot:d("foot",f.foot,p,o,c,r)}}function d(l,r,f,p,y,c){var o={},F=r.map(function(z,j){for(var h=0,i={},P=0,g=0,x=0,H=f;x<H.length;x++){var k=H[x];if(o[k.index]==null||o[k.index].left===0)if(g===0){var T=void 0;Array.isArray(z)?T=z[k.index-P-h]:T=z[k.dataKey];var W={};typeof T=="object"&&!Array.isArray(T)&&(W=(T==null?void 0:T.styles)||{});var A=s(l,k,j,y,p,c,W),_=new v.Cell(T,A,l);i[k.dataKey]=_,i[k.index]=_,g=_.colSpan-1,o[k.index]={left:_.rowSpan-1,times:g}}else g--,P++;else o[k.index].left--,g=o[k.index].times,h++}return new v.Row(z,j,l,i)});return F}function a(l,r){var f={};return l.forEach(function(p){if(p.raw!=null){var y=t(r,p.raw);y!=null&&(f[p.dataKey]=y)}}),Object.keys(f).length>0?f:null}function t(l,r){if(l==="head"){if(typeof r=="object")return r.header||r.title||null;if(typeof r=="string"||typeof r=="number")return r}else if(l==="foot"&&typeof r=="object")return r.footer;return null}function n(l){return l.map(function(r,f){var p,y,c;return typeof r=="object"?c=(y=(p=r.dataKey)!==null&&p!==void 0?p:r.key)!==null&&y!==void 0?y:f:c=f,new v.Column(c,r,f)})}function s(l,r,f,p,y,c,o){var F=(0,w.getTheme)(p),z;l==="head"?z=y.headStyles:l==="body"?z=y.bodyStyles:l==="foot"&&(z=y.footStyles);var j=(0,e.assign)({},F.table,F[l],y.styles,z),h=y.columnStyles[r.dataKey]||y.columnStyles[r.index]||{},i=l==="body"?h:{},P=l==="body"&&f%2===0?(0,e.assign)({},F.alternateRow,y.alternateRowStyles):{},g=(0,w.defaultStyles)(c),x=(0,e.assign)({},g,j,P,i);return(0,e.assign)(x,o)}},664:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.addPage=S.drawTable=void 0;var R=b(420),v=b(260),u=b(744),w=b(356),e=b(136),C=b(224);function m(h,i){var P=i.settings,g=P.startY,x=P.margin,H={x:x.left,y:g},k=i.getHeadHeight(i.columns)+i.getFootHeight(i.columns),T=g+x.bottom+k;if(P.pageBreak==="avoid"){var W=i.body,A=W.reduce(function(O,I){return O+I.height},0);T+=A}var _=new u.DocHandler(h);(P.pageBreak==="always"||P.startY!=null&&T>_.pageSize().height)&&(j(_),H.y=x.top),i.callWillDrawPageHooks(_,H);var M=(0,w.assign)({},H);i.startPageNumber=_.pageNumber(),P.horizontalPageBreak?d(_,i,M,H):(_.applyStyles(_.userStyles),(P.showHead==="firstPage"||P.showHead==="everyPage")&&i.head.forEach(function(O){return y(_,i,O,H,i.columns)}),_.applyStyles(_.userStyles),i.body.forEach(function(O,I){var G=I===i.body.length-1;p(_,i,O,G,M,H,i.columns)}),_.applyStyles(_.userStyles),(P.showFoot==="lastPage"||P.showFoot==="everyPage")&&i.foot.forEach(function(O){return y(_,i,O,H,i.columns)})),(0,R.addTableBorder)(_,i,M,H),i.callEndPageHooks(_,H),i.finalY=H.y,h.lastAutoTable=i,h.previousAutoTable=i,h.autoTable&&(h.autoTable.previous=i),_.applyStyles(_.userStyles)}S.drawTable=m;function d(h,i,P,g){var x=(0,C.calculateAllColumnsCanFitInPage)(h,i),H=i.settings;if(H.horizontalPageBreakBehaviour==="afterAllRows")x.forEach(function(A,_){h.applyStyles(h.userStyles),_>0?z(h,i,P,g,A.columns,!0):a(h,i,g,A.columns),t(h,i,P,g,A.columns),s(h,i,g,A.columns)});else for(var k=-1,T=x[0],W=function(){var A=k;if(T){h.applyStyles(h.userStyles);var _=T.columns;k>=0?z(h,i,P,g,_,!0):a(h,i,g,_),A=n(h,i,k+1,g,_),s(h,i,g,_)}var M=A-k;x.slice(1).forEach(function(O){h.applyStyles(h.userStyles),z(h,i,P,g,O.columns,!0),n(h,i,k+1,g,O.columns,M),s(h,i,g,O.columns)}),k=A};k<i.body.length-1;)W()}function a(h,i,P,g){var x=i.settings;h.applyStyles(h.userStyles),(x.showHead==="firstPage"||x.showHead==="everyPage")&&i.head.forEach(function(H){return y(h,i,H,P,g)})}function t(h,i,P,g,x){h.applyStyles(h.userStyles),i.body.forEach(function(H,k){var T=k===i.body.length-1;p(h,i,H,T,P,g,x)})}function n(h,i,P,g,x,H){h.applyStyles(h.userStyles),H=H??i.body.length;var k=Math.min(P+H,i.body.length),T=-1;return i.body.slice(P,k).forEach(function(W,A){var _=P+A===i.body.length-1,M=F(h,i,_,g);W.canEntireRowFit(M,x)&&(y(h,i,W,g,x),T=P+A)}),T}function s(h,i,P,g){var x=i.settings;h.applyStyles(h.userStyles),(x.showFoot==="lastPage"||x.showFoot==="everyPage")&&i.foot.forEach(function(H){return y(h,i,H,P,g)})}function l(h,i,P){var g=P.getLineHeight(h.styles.fontSize),x=h.padding("vertical"),H=Math.floor((i-x)/g);return Math.max(0,H)}function r(h,i,P,g){var x={};h.spansMultiplePages=!0,h.height=0;for(var H=0,k=0,T=P.columns;k<T.length;k++){var W=T[k],A=h.cells[W.index];if(A){Array.isArray(A.text)||(A.text=[A.text]);var _=new v.Cell(A.raw,A.styles,A.section);_=(0,w.assign)(_,A),_.text=[];var M=l(A,i,g);A.text.length>M&&(_.text=A.text.splice(M,A.text.length));var O=g.scaleFactor(),I=g.getLineHeightFactor();A.contentHeight=A.getContentHeight(O,I),A.contentHeight>=i&&(A.contentHeight=i,_.styles.minCellHeight-=i),A.contentHeight>h.height&&(h.height=A.contentHeight),_.contentHeight=_.getContentHeight(O,I),_.contentHeight>H&&(H=_.contentHeight),x[W.index]=_}}var G=new v.Row(h.raw,-1,h.section,x,!0);G.height=H;for(var K=0,q=P.columns;K<q.length;K++){var W=q[K],_=G.cells[W.index];_&&(_.height=G.height);var A=h.cells[W.index];A&&(A.height=h.height)}return G}function f(h,i,P,g){var x=h.pageSize().height,H=g.settings.margin,k=H.top+H.bottom,T=x-k;i.section==="body"&&(T-=g.getHeadHeight(g.columns)+g.getFootHeight(g.columns));var W=i.getMinimumRowHeight(g.columns,h),A=W<P;if(W>T)return console.error("Will not be able to print row ".concat(i.index," correctly since it's minimum height is larger than page height")),!0;if(!A)return!1;var _=i.hasRowSpan(g.columns),M=i.getMaxCellHeight(g.columns)>T;return M?(_&&console.error("The content of row ".concat(i.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(_||g.settings.rowPageBreak==="avoid")}function p(h,i,P,g,x,H,k){var T=F(h,i,g,H);if(P.canEntireRowFit(T,k))y(h,i,P,H,k);else if(f(h,P,T,i)){var W=r(P,T,i,h);y(h,i,P,H,k),z(h,i,x,H,k),p(h,i,W,g,x,H,k)}else z(h,i,x,H,k),p(h,i,P,g,x,H,k)}function y(h,i,P,g,x){g.x=i.settings.margin.left;for(var H=0,k=x;H<k.length;H++){var T=k[H],W=P.cells[T.index];if(!W){g.x+=T.width;continue}h.applyStyles(W.styles),W.x=g.x,W.y=g.y;var A=i.callCellHooks(h,i.hooks.willDrawCell,W,P,T,g);if(A===!1){g.x+=T.width;continue}c(h,W,g);var _=W.getTextPos();(0,e.default)(W.text,_.x,_.y,{halign:W.styles.halign,valign:W.styles.valign,maxWidth:Math.ceil(W.width-W.padding("left")-W.padding("right"))},h.getDocument()),i.callCellHooks(h,i.hooks.didDrawCell,W,P,T,g),g.x+=T.width}g.y+=P.height}function c(h,i,P){var g=i.styles;if(h.getDocument().setFillColor(h.getDocument().getFillColor()),typeof g.lineWidth=="number"){var x=(0,R.getFillStyle)(g.lineWidth,g.fillColor);x&&h.rect(i.x,P.y,i.width,i.height,x)}else typeof g.lineWidth=="object"&&(g.fillColor&&h.rect(i.x,P.y,i.width,i.height,"F"),o(h,i,P,g.lineWidth))}function o(h,i,P,g){var x,H,k,T;g.top&&(x=P.x,H=P.y,k=P.x+i.width,T=P.y,g.right&&(k+=.5*g.right),g.left&&(x-=.5*g.left),W(g.top,x,H,k,T)),g.bottom&&(x=P.x,H=P.y+i.height,k=P.x+i.width,T=P.y+i.height,g.right&&(k+=.5*g.right),g.left&&(x-=.5*g.left),W(g.bottom,x,H,k,T)),g.left&&(x=P.x,H=P.y,k=P.x,T=P.y+i.height,g.top&&(H-=.5*g.top),g.bottom&&(T+=.5*g.bottom),W(g.left,x,H,k,T)),g.right&&(x=P.x+i.width,H=P.y,k=P.x+i.width,T=P.y+i.height,g.top&&(H-=.5*g.top),g.bottom&&(T+=.5*g.bottom),W(g.right,x,H,k,T));function W(A,_,M,O,I){h.getDocument().setLineWidth(A),h.getDocument().line(_,M,O,I,"S")}}function F(h,i,P,g){var x=i.settings.margin.bottom,H=i.settings.showFoot;return(H==="everyPage"||H==="lastPage"&&P)&&(x+=i.getFootHeight(i.columns)),h.pageSize().height-g.y-x}function z(h,i,P,g,x,H){x===void 0&&(x=[]),H===void 0&&(H=!1),h.applyStyles(h.userStyles),i.settings.showFoot==="everyPage"&&!H&&i.foot.forEach(function(T){return y(h,i,T,g,x)}),i.callEndPageHooks(h,g);var k=i.settings.margin;(0,R.addTableBorder)(h,i,P,g),j(h),i.pageNumber++,i.pageCount++,g.x=k.left,g.y=k.top,P.y=k.top,i.callWillDrawPageHooks(h,g),i.settings.showHead==="everyPage"&&(i.head.forEach(function(T){return y(h,i,T,g,x)}),h.applyStyles(h.userStyles))}S.addPage=z;function j(h){var i=h.pageNumber();h.setPage(i+1);var P=h.pageNumber();return P===i?(h.addPage(),!0):!1}},224:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.calculateAllColumnsCanFitInPage=void 0;var R=b(420);function v(w,e,C){var m;C===void 0&&(C={});var d=(0,R.getPageAvailableWidth)(w,e),a=new Map,t=[],n=[],s=[];e.settings.horizontalPageBreakRepeat,Array.isArray(e.settings.horizontalPageBreakRepeat)?s=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(s=[e.settings.horizontalPageBreakRepeat]),s.forEach(function(p){var y=e.columns.find(function(c){return c.dataKey===p||c.index===p});y&&!a.has(y.index)&&(a.set(y.index,!0),t.push(y.index),n.push(e.columns[y.index]),d-=y.wrappedWidth)});for(var l=!0,r=(m=C==null?void 0:C.start)!==null&&m!==void 0?m:0;r<e.columns.length;){if(a.has(r)){r++;continue}var f=e.columns[r].wrappedWidth;if(l||d>=f)l=!1,t.push(r),n.push(e.columns[r]),d-=f;else break;r++}return{colIndexes:t,columns:n,lastIndex:r-1}}function u(w,e){for(var C=[],m=0;m<e.columns.length;m++){var d=v(w,e,{start:m});d.columns.length&&(C.push(d),m=d.lastIndex)}return C}S.calculateAllColumnsCanFitInPage=u},324:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.ellipsize=S.resizeColumns=S.calculateWidths=void 0;var R=b(420);function v(t,n){u(t,n);var s=[],l=0;n.columns.forEach(function(f){var p=f.getMaxCustomCellWidth(n);p?f.width=p:(f.width=f.wrappedWidth,s.push(f)),l+=f.width});var r=n.getWidth(t.pageSize().width)-l;r&&(r=w(s,r,function(f){return Math.max(f.minReadableWidth,f.minWidth)})),r&&(r=w(s,r,function(f){return f.minWidth})),r=Math.abs(r),!n.settings.horizontalPageBreak&&r>.1/t.scaleFactor()&&(r=r<1?r:Math.round(r),console.warn("Of the table content, ".concat(r," units width could not fit page"))),C(n),m(n,t),e(n)}S.calculateWidths=v;function u(t,n){var s=t.scaleFactor(),l=n.settings.horizontalPageBreak,r=(0,R.getPageAvailableWidth)(t,n);n.allRows().forEach(function(f){for(var p=0,y=n.columns;p<y.length;p++){var c=y[p],o=f.cells[c.index];if(o){var F=n.hooks.didParseCell;n.callCellHooks(t,F,o,f,c,null);var z=o.padding("horizontal");o.contentWidth=(0,R.getStringWidth)(o.text,o.styles,t)+z;var j=(0,R.getStringWidth)(o.text.join(" ").split(/[^\S\u00A0]+/),o.styles,t);if(o.minReadableWidth=j+o.padding("horizontal"),typeof o.styles.cellWidth=="number")o.minWidth=o.styles.cellWidth,o.wrappedWidth=o.styles.cellWidth;else if(o.styles.cellWidth==="wrap"||l===!0)o.contentWidth>r?(o.minWidth=r,o.wrappedWidth=r):(o.minWidth=o.contentWidth,o.wrappedWidth=o.contentWidth);else{var h=10/s;o.minWidth=o.styles.minCellWidth||h,o.wrappedWidth=o.contentWidth,o.minWidth>o.wrappedWidth&&(o.wrappedWidth=o.minWidth)}}}}),n.allRows().forEach(function(f){for(var p=0,y=n.columns;p<y.length;p++){var c=y[p],o=f.cells[c.index];if(o&&o.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,o.wrappedWidth),c.minWidth=Math.max(c.minWidth,o.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,o.minReadableWidth);else{var F=n.styles.columnStyles[c.dataKey]||n.styles.columnStyles[c.index]||{},z=F.cellWidth||F.minCellWidth;z&&typeof z=="number"&&(c.minWidth=z,c.wrappedWidth=z)}o&&(o.colSpan>1&&!c.minWidth&&(c.minWidth=o.minWidth),o.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=o.minWidth))}})}function w(t,n,s){for(var l=n,r=t.reduce(function(h,i){return h+i.wrappedWidth},0),f=0;f<t.length;f++){var p=t[f],y=p.wrappedWidth/r,c=l*y,o=p.width+c,F=s(p),z=o<F?F:o;n-=z-p.width,p.width=z}if(n=Math.round(n*1e10)/1e10,n){var j=t.filter(function(h){return n<0?h.width>s(h):!0});j.length&&(n=w(j,n,s))}return n}S.resizeColumns=w;function e(t){for(var n={},s=1,l=t.allRows(),r=0;r<l.length;r++)for(var f=l[r],p=0,y=t.columns;p<y.length;p++){var c=y[p],o=n[c.index];if(s>1)s--,delete f.cells[c.index];else if(o)o.cell.height+=f.height,s=o.cell.colSpan,delete f.cells[c.index],o.left--,o.left<=1&&delete n[c.index];else{var F=f.cells[c.index];if(!F)continue;if(F.height=f.height,F.rowSpan>1){var z=l.length-r,j=F.rowSpan>z?z:F.rowSpan;n[c.index]={cell:F,left:j,row:f}}}}}function C(t){for(var n=t.allRows(),s=0;s<n.length;s++)for(var l=n[s],r=null,f=0,p=0,y=0;y<t.columns.length;y++){var c=t.columns[y];if(p-=1,p>1&&t.columns[y+1])f+=c.width,delete l.cells[c.index];else if(r){var o=r;delete l.cells[c.index],r=null,o.width=c.width+f}else{var o=l.cells[c.index];if(!o)continue;if(p=o.colSpan,f=0,o.colSpan>1){r=o,f+=c.width;continue}o.width=c.width+f}}}function m(t,n){for(var s={count:0,height:0},l=0,r=t.allRows();l<r.length;l++){for(var f=r[l],p=0,y=t.columns;p<y.length;p++){var c=y[p],o=f.cells[c.index];if(o){n.applyStyles(o.styles,!0);var F=o.width-o.padding("horizontal");if(o.styles.overflow==="linebreak")o.text=n.splitTextToSize(o.text,F+1/n.scaleFactor(),{fontSize:o.styles.fontSize});else if(o.styles.overflow==="ellipsize")o.text=d(o.text,F,o.styles,n,"...");else if(o.styles.overflow==="hidden")o.text=d(o.text,F,o.styles,n,"");else if(typeof o.styles.overflow=="function"){var z=o.styles.overflow(o.text,F);typeof z=="string"?o.text=[z]:o.text=z}o.contentHeight=o.getContentHeight(n.scaleFactor(),n.getLineHeightFactor());var j=o.contentHeight/o.rowSpan;o.rowSpan>1&&s.count*s.height<j*o.rowSpan?s={height:j,count:o.rowSpan}:s&&s.count>0&&s.height>j&&(j=s.height),j>f.height&&(f.height=j)}}s.count--}}function d(t,n,s,l,r){return t.map(function(f){return a(f,n,s,l,r)})}S.ellipsize=d;function a(t,n,s,l,r){var f=1e4*l.scaleFactor();if(n=Math.ceil(n*f)/f,n>=(0,R.getStringWidth)(t,s,l))return t;for(;n<(0,R.getStringWidth)(t+r,s,l)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+r}},964:function(E){if(typeof N>"u"){var S=new Error("Cannot find module 'undefined'");throw S.code="MODULE_NOT_FOUND",S}E.exports=N}},D={};function B(E){var S=D[E];if(S!==void 0)return S.exports;var b=D[E]={exports:{}};return L[E].call(b.exports,b,b.exports,B),b.exports}var Y={};return function(){var E=Y;Object.defineProperty(E,"__esModule",{value:!0}),E.Cell=E.Column=E.Row=E.Table=E.CellHookData=E.__drawTable=E.__createTable=E.applyPlugin=void 0;var S=B(340),b=B(776),R=B(664),v=B(972),u=B(260);Object.defineProperty(E,"Table",{enumerable:!0,get:function(){return u.Table}});var w=B(172);Object.defineProperty(E,"CellHookData",{enumerable:!0,get:function(){return w.CellHookData}});var e=B(260);Object.defineProperty(E,"Cell",{enumerable:!0,get:function(){return e.Cell}}),Object.defineProperty(E,"Column",{enumerable:!0,get:function(){return e.Column}}),Object.defineProperty(E,"Row",{enumerable:!0,get:function(){return e.Row}});function C(n){(0,S.default)(n)}E.applyPlugin=C;function m(n,s){var l=(0,b.parseInput)(n,s),r=(0,v.createTable)(n,l);(0,R.drawTable)(n,r)}function d(n,s){var l=(0,b.parseInput)(n,s);return(0,v.createTable)(n,l)}E.__createTable=d;function a(n,s){(0,R.drawTable)(n,s)}E.__drawTable=a;try{var t=B(964);t.jsPDF&&(t=t.jsPDF),C(t)}catch{}E.default=m}(),Y}()})})(nt);var ut=nt.exports;const Z=ot(ut);et.register(...st);const ht=(U,Q)=>new Promise(N=>{const L=document.createElement("canvas");L.width=1e3,L.height=1e3;const D=L.getContext("2d");if(!D){N("");return}D.fillStyle="#FFFFFF",D.fillRect(0,0,L.width,L.height);const B=["cacao","acidity","bitterness","astringency","fresh_fruit","browned_fruit","vegetal","floral","woody","spice","nutty","caramel","sweetness","defects","roast"],Y=(u,w)=>X[u]?Q==="es"?X[u].es.toUpperCase():X[u].en.toUpperCase():w?Q==="es"?w.nameEs.toUpperCase():w.nameEn.toUpperCase():u.toUpperCase(),E=B.map(u=>{const w=U.find(e=>e.id===u);return Y(u,w)}),S=B.map(u=>{const w=U.find(e=>e.id===u);return w?w.score:0}),b=B.map(u=>V(u)),R={id:"custom_white_bg",beforeDraw:u=>{const{ctx:w,width:e,height:C}=u;w.save(),w.fillStyle="#FFFFFF",w.fillRect(0,0,e,C),w.restore()}},v=new et(D,{type:"polarArea",data:{labels:E,datasets:[{data:S,backgroundColor:b,borderWidth:2,borderColor:"#ffffff"}]},options:{responsive:!1,animation:!1,layout:{padding:5},scales:{r:{min:0,max:10,ticks:{stepSize:2,z:1,backdropColor:"white",color:"#8c5e4a",font:{size:24}},grid:{color:"#eaddd7",circular:!0},angleLines:{display:!0,color:"#eaddd7"},pointLabels:{display:!0,centerPointLabels:!0,font:{size:20,family:"sans-serif",weight:"bold"},color:"#4a2e24",padding:10}}},plugins:{legend:{display:!1}}},plugins:[R]});setTimeout(()=>{const u=document.createElement("canvas");u.width=L.width,u.height=L.height;const w=u.getContext("2d");if(w){w.fillStyle="#FFFFFF",w.fillRect(0,0,u.width,u.height),w.drawImage(L,0,0);const e=u.toDataURL("image/jpeg",.9);v.destroy(),N(e)}else{const e=L.toDataURL("image/jpeg",.9);v.destroy(),N(e)}},100)}),bt=async(U,Q,N)=>{var Y,E;const L=Array.isArray(U)?U:[U];if(L.length===0)return;const D=new rt;for(let S=0;S<L.length;S++){const b=L[S];S>0&&D.addPage();const R=b.language==="es",v=(a,t)=>R?t:a;let u=Q;(!u||L.length>1)&&(u=await ht(b.attributes,b.language)),D.setFontSize(18),D.setTextColor(74,46,36),D.text(v("Cacao of Excellence - Sensory Evaluation","Cacao de Excelencia - Evaluación Sensorial"),14,20);const w=[[v("Evaluator","Evaluador"),b.metadata.evaluator||"-"],[v("Sample Code","Código de Muestra"),b.metadata.sampleCode||"-"],[v("Date","Fecha"),lt(b.metadata.date,b.language)||"-"],[v("Time","Hora"),b.metadata.time||"-"],[v("Type","Tipo"),b.metadata.evaluationType==="cacao_mass"?v("Cacao Mass","Masa de Cacao"):v("Chocolate","Chocolate")],[v("Sample Info","Info Muestra"),b.metadata.sampleInfo||"-"]];Z(D,{startY:30,body:w,theme:"striped",headStyles:{fillColor:[117,74,41]},styles:{fontSize:10,cellPadding:3},columnStyles:{0:{fontStyle:"bold",cellWidth:50}}});let e=D.lastAutoTable.finalY+10;D.setFontSize(12),D.setTextColor(74,46,36),D.setFont("helvetica","bold"),D.text(`${v("Global Quality Score","Calidad Global")}: ${b.globalQuality}/10`,14,e),e+=7,D.setFontSize(11),D.setFont("helvetica","normal");let C="-";if(b.selectedQualityId){const a=$.find(t=>t.id===b.selectedQualityId);a&&(C=R?a.nameEs:a.nameEn)}if(D.text(`${v("Additional Positive Qualities","Cualidades positivas adicionales")}: ${C}`,14,e),e+=10,u){const a=D.internal.pageSize.getWidth(),t=140,n=140,s=(a-t)/2;e+n>270&&(D.addPage(),e=20),D.addImage(u,"JPEG",s,e,t,n),e+=n+10}const m=b.attributes.map(a=>{var s;const t=R?a.nameEs:a.nameEn,n=(s=a.subAttributes)==null?void 0:s.filter(l=>l.score>0).map(l=>`${R?l.nameEs:l.nameEn}: ${l.score}`).join(", ");return[t,a.score.toString(),n||""]});Z(D,{startY:e,head:[[v("Attribute","Atributo"),{content:v("Score","Puntaje"),styles:{halign:"center"}},v("Descriptors","Descriptores")]],body:m,theme:"grid",headStyles:{fillColor:[117,74,41]},columnStyles:{0:{fontStyle:"bold",cellWidth:50},1:{halign:"center",cellWidth:25}},styles:{fontSize:9}}),e=D.lastAutoTable.finalY+10;const d=(a,t)=>{if(!t)return;e>260&&(D.addPage(),e=20),D.setFontSize(11),D.setFont("helvetica","bold"),D.setTextColor(0,0,0),D.text(a,14,e),e+=6,D.setFontSize(10),D.setFont("helvetica","normal");const n=D.splitTextToSize(t,180);D.text(n,14,e),e+=n.length*5+8};if(d(v("Judge's Notes","Notas del Juez"),b.metadata.notes),d(v("Producer Recommendations","Recomendaciones al Productor"),b.metadata.producerRecommendations),b.tdsProfile&&((Y=b.tdsProfile.events)==null?void 0:Y.length)>0){e>230&&(D.addPage(),e=20),e+=10,D.setFontSize(14),D.setFont("helvetica","bold"),D.setTextColor(74,46,36),D.text(v("TDS Analysis","Análisis TDS"),14,e),e+=8;const a=b.tdsProfile;let t=b.tdsProfile.analysis;if(!t)try{t=tt(a)}catch(x){console.error("TDS Analysis failed for PDF",x)}D.setFontSize(10),D.setFont("helvetica","normal"),D.setTextColor(0,0,0);const n=v("Total Duration","Duración Total"),s=v("Swallow","Tragado"),l=v("Mode","Modo"),r=a.mode==="expert"?R?"Experto":"Expert":"Normal",f=a.swallowTime;if(D.text(`${n}: ${a.totalDuration.toFixed(1)}s`,14,e),D.text(`${s}: ${f.toFixed(1)}s`,80,e),D.text(`${l}: ${r}`,150,e),e+=6,t){const x=t.firstOnset||0,H=a.totalDuration-f,k=v("First Flavor Onset","Primer Sabor"),T=v("Aftertaste Duration","Duración Post-gusto");D.text(`${k}: ${x.toFixed(1)}s`,14,e),D.text(`${T}: ${H.toFixed(1)}s`,80,e)}e+=12;const p=14,y=180,c=20,o=y/(a.totalDuration||1),F=(t==null?void 0:t.firstOnset)||0,z=F+((t==null?void 0:t.attackPhaseDuration)||0),j=f,h=a.totalDuration,i=p+F*o,P=p+z*o,g=p+j*o;if(D.setFontSize(7),D.setTextColor(80),D.text("0%",i,e-6,{align:"center"}),D.text("20%",P,e-6,{align:"center"}),D.setFont("helvetica","bold"),D.text("100%",g,e-6,{align:"center"}),D.setFont("helvetica","normal"),D.setDrawColor(200),D.setFillColor(245,245,245),D.rect(p,e,y,c,"FD"),a.events.forEach(x=>{const H=p+x.start*o,k=(x.end-x.start)*o;if(k<.2)return;const T=V(x.attrId);D.setFillColor(T),D.rect(H,e,k,c,"F")}),t&&t.attackPhaseDuration>0&&(D.setDrawColor(100),D.setLineWidth(.5),D.setLineDashPattern([1,1],0),D.line(P,e-2,P,e+c+2),D.setLineDashPattern([],0)),j>0&&(D.setDrawColor(0),D.setLineWidth(.8),D.line(g,e-2,g,e+c+2)),e+=c,D.setFontSize(7),D.setTextColor(80),D.text(`${F.toFixed(1)}s`,i,e+5,{align:"center"}),D.text(`${z.toFixed(1)}s`,P,e+5,{align:"center"}),D.setFont("helvetica","bold"),D.text(`${j.toFixed(1)}s`,g,e+5,{align:"center"}),D.setFont("helvetica","normal"),D.text(`${h.toFixed(1)}s`,p+y,e+5,{align:"right"}),e+=15,t&&t.scores){e+=5;let x=[];t.scores instanceof Map?x=Array.from(t.scores.entries()):x=Object.entries(t.scores);const H=x.filter(([T,W])=>W.durationPercent>0).sort((T,W)=>W[1].score-T[1].score),k=H.map(([T,W])=>{const A=b.attributes.find(I=>I.id===T)||$.find(I=>I.id===T);let _=T;A?_=R?A.nameEs:A.nameEn:_=T.charAt(0).toUpperCase()+T.slice(1).replace("_"," ");const O=W.originalScore!==void 0&&W.originalScore<W.score?`${W.score} (*)`:W.score.toString();return["",_,`${W.durationPercent.toFixed(1)}%`,O]});if(Z(D,{startY:e,head:[["",v("TDS Attribute","Atributo TDS"),{content:v("Dominance %","Dominancia %"),styles:{halign:"center"}},{content:v("CoEx Score","Puntaje CoEx"),styles:{halign:"center"}}]],body:k,theme:"grid",headStyles:{fillColor:[150,150,150],textColor:255},styles:{fontSize:8,cellPadding:2},columnStyles:{0:{cellWidth:8},1:{cellWidth:80},2:{halign:"center"},3:{halign:"center",fontStyle:"bold"}},margin:{left:14,right:14},didDrawCell:T=>{if(T.section==="body"&&T.column.index===0){const W=T.row.index;if(W<H.length){const A=H[W][0],_=V(A),M=4,O=T.cell.x+(T.cell.width-M)/2,I=T.cell.y+(T.cell.height-M)/2;D.setFillColor(_),D.rect(O,I,M,M,"F")}}}}),e=D.lastAutoTable.finalY+10,b.tdsProfile&&(!t||t.aromaPercent===void 0||t.aftertastePercent===void 0||t.kickSuggestions&&t.kickSuggestions.some(W=>typeof W=="string")||t.qualitySuggestions&&t.qualitySuggestions.some(W=>typeof W=="string"))&&(console.log(`[PDF] Recalculating analysis for sample ${S+1} due to missing fields or legacy format.`),t=tt({mode:b.tdsProfile.mode,events:b.tdsProfile.events,swallowTime:b.tdsProfile.swallowTime,totalDuration:b.tdsProfile.totalDuration})),t&&t.aromaNotes.length>0){const W=t.aromaNotes.map(A=>{const _=b.attributes.find(M=>M.id===A)||b.attributes.flatMap(M=>M.subAttributes||[]).find(M=>M.id===A);return _?R?_.nameEs:_.nameEn:A}).join(", ");if(W){const A=v(`Dominant Aromas (${t.aromaPercent}%)`,`Aromas Dominantes (${t.aromaPercent}%)`);d(A,W)}}if(t){const T={cacao:{en:"Cacao",es:"Cacao"},acidity:{en:"Acidity",es:"Acidez"},bitterness:{en:"Bitterness",es:"Amargor"},astringency:{en:"Astringency",es:"Astringencia"},roast:{en:"Roast",es:"Tostado"},fresh_fruit:{en:"Fresh Fruit",es:"Fruta Fresca"},browned_fruit:{en:"Browned Fruit",es:"Fruta Marrón"},vegetal:{en:"Vegetal",es:"Vegetal"},floral:{en:"Floral",es:"Floral"},woody:{en:"Woody",es:"Madera"},spice:{en:"Spice",es:"Especia"},nutty:{en:"Nutty",es:"Nuez"},caramel:{en:"Caramel",es:"Caramelo"},sweetness:{en:"Sweetness",es:"Dulzor"},defects:{en:"Defects",es:"Defectos"}};if(t.dominantAftertaste){const W=((E=T[t.dominantAftertaste])==null?void 0:E[R?"es":"en"])||t.dominantAftertaste,A=v(`Dominant Aftertaste (${t.aftertastePercent}%)`,`Post-gusto Dominante (${t.aftertastePercent}%)`);d(A,W)}if(t.aftertasteBoosts&&t.aftertasteBoosts.length>0){const W=t.aftertasteBoosts.map(A=>{var M;return`${((M=T[A.attrId])==null?void 0:M[R?"es":"en"])||A.attrId} +${A.amount}`}).join(", ");d(v("Aftertaste Boosts","Refuerzos de Post-gusto"),W)}if(t.qualityModifier!==0){const W=t.qualityModifier>0?"+":"";d(v("Suggested Global Quality Adjustment","Ajuste de Calidad Global Sugerido"),`${W}${t.qualityModifier}`)}if(t.kickSuggestions&&t.kickSuggestions.length>0){const W=t.kickSuggestions.map(A=>typeof A=="string"?A:A[R?"es":"en"]).join(`
`);d(v("Initial Kick Insights","Observaciones del Impacto Inicial"),W)}if(t.qualitySuggestions&&t.qualitySuggestions.length>0){const W=t.qualitySuggestions.map(A=>typeof A=="string"?A:A[R?"es":"en"]).join(`
`);d(v("Aftertaste Quality Insights","Observaciones de Calidad del Post-gusto"),W)}}}}D.setFontSize(8),D.setTextColor(150),D.text(`${v("Sample","Muestra")} ${S+1} / ${L.length}`,14,290,{align:"left"})}let B=N;if(!B){const S=ft();B=L.length===1?`CoEx_${L[0].metadata.sampleCode||"Report"}.pdf`:`CoEx_Bulk_Report_${S}.pdf`}B.toLowerCase().endsWith(".pdf")||(B+=".pdf"),D.save(B)};export{bt as generatePdf};
