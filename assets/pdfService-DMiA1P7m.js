import{j as it,E as rt}from"./jspdf.es.min-CuvU_NwC.js";import{k as ot,g as st,h as J,a as $,I as tt}from"./index-Cc-s5RXY.js";import{A as X}from"./attributes-zDdy4c7G.js";import{C as nt,r as lt}from"./index-3Ey7Uc7E.js";import{g as V}from"./colors-C8jCGJn0.js";import{a as et}from"./tdsCalculator-DoBBydFW.js";import{f as ft,b as dt}from"./dateUtils-BSM0ms4X.js";var at={exports:{}};const ut=ot(it);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(U,Q){(function(L,T){U.exports=T(function(){try{return ut}catch{}}())})(typeof globalThis<"u"?globalThis:typeof J<"u"?J:typeof window<"u"?window:typeof self<"u"?self:J,function(N){return function(){var L={172:function(E,S){var b=this&&this.__extends||function(){var u=function(w,e){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,m){C.__proto__=m}||function(C,m){for(var d in m)Object.prototype.hasOwnProperty.call(m,d)&&(C[d]=m[d])},u(w,e)};return function(w,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");u(w,e);function C(){this.constructor=w}w.prototype=e===null?Object.create(e):(C.prototype=e.prototype,new C)}}();Object.defineProperty(S,"__esModule",{value:!0}),S.CellHookData=S.HookData=void 0;var R=function(){function u(w,e,C){this.table=e,this.pageNumber=e.pageNumber,this.pageCount=this.pageNumber,this.settings=e.settings,this.cursor=C,this.doc=w.getDocument()}return u}();S.HookData=R;var v=function(u){b(w,u);function w(e,C,m,d,a,t){var n=u.call(this,e,C,t)||this;return n.cell=m,n.row=d,n.column=a,n.section=d.section,n}return w}(R);S.CellHookData=v},340:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0});var R=b(4),v=b(136),u=b(744),w=b(776),e=b(664),C=b(972);function m(d){d.API.autoTable=function(){for(var a=[],t=0;t<arguments.length;t++)a[t]=arguments[t];var n;a.length===1?n=a[0]:(console.error("Use of deprecated autoTable initiation"),n=a[2]||{},n.columns=a[0],n.body=a[1]);var s=(0,w.parseInput)(this,n),l=(0,C.createTable)(this,s);return(0,e.drawTable)(this,l),this},d.API.lastAutoTable=!1,d.API.previousAutoTable=!1,d.API.autoTable.previous=!1,d.API.autoTableText=function(a,t,n,s){(0,v.default)(a,t,n,s,this)},d.API.autoTableSetDefaults=function(a){return u.DocHandler.setDefaults(a,this),this},d.autoTableSetDefaults=function(a,t){u.DocHandler.setDefaults(a,t)},d.API.autoTableHtmlToJson=function(a,t){var n;if(t===void 0&&(t=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var s=new u.DocHandler(this),l=(0,R.parseHtml)(s,a,window,t,!1),i=l.head,f=l.body,p=((n=i[0])===null||n===void 0?void 0:n.map(function(y){return y.content}))||[];return{columns:p,rows:f,data:f}},d.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var a=this.lastAutoTable;return a&&a.finalY?a.finalY:0},d.API.autoTableAddPageContent=function(a){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),d.API.autoTable.globalDefaults||(d.API.autoTable.globalDefaults={}),d.API.autoTable.globalDefaults.addPageContent=a,this},d.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}S.default=m},136:function(E,S){Object.defineProperty(S,"__esModule",{value:!0});function b(R,v,u,w,e){w=w||{};var C=1.15,m=e.internal.scaleFactor,d=e.internal.getFontSize()/m,a=e.getLineHeightFactor?e.getLineHeightFactor():C,t=d*a,n=/\r\n|\r|\n/g,s="",l=1;if((w.valign==="middle"||w.valign==="bottom"||w.halign==="center"||w.halign==="right")&&(s=typeof R=="string"?R.split(n):R,l=s.length||1),u+=d*(2-C),w.valign==="middle"?u-=l/2*t:w.valign==="bottom"&&(u-=l*t),w.halign==="center"||w.halign==="right"){var i=d;if(w.halign==="center"&&(i*=.5),s&&l>=1){for(var f=0;f<s.length;f++)e.text(s[f],v-e.getStringUnitWidth(s[f])*i,u),u+=t;return e}v-=e.getStringUnitWidth(R)*i}return w.halign==="justify"?e.text(R,v,u,{maxWidth:w.maxWidth||100,align:"justify"}):e.text(R,v,u),e}S.default=b},420:function(E,S){Object.defineProperty(S,"__esModule",{value:!0}),S.getPageAvailableWidth=S.parseSpacing=S.getFillStyle=S.addTableBorder=S.getStringWidth=void 0;function b(e,C,m){m.applyStyles(C,!0);var d=Array.isArray(e)?e:[e],a=d.map(function(t){return m.getTextWidth(t)}).reduce(function(t,n){return Math.max(t,n)},0);return a}S.getStringWidth=b;function R(e,C,m,d){var a=C.settings.tableLineWidth,t=C.settings.tableLineColor;e.applyStyles({lineWidth:a,lineColor:t});var n=v(a,!1);n&&e.rect(m.x,m.y,C.getWidth(e.pageSize().width),d.y-m.y,n)}S.addTableBorder=R;function v(e,C){var m=e>0,d=C||C===0;return m&&d?"DF":m?"S":d?"F":null}S.getFillStyle=v;function u(e,C){var m,d,a,t;if(e=e||C,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=C}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(m=e.left)!==null&&m!==void 0?m:C,top:(d=e.top)!==null&&d!==void 0?d:C,right:(a=e.right)!==null&&a!==void 0?a:C,bottom:(t=e.bottom)!==null&&t!==void 0?t:C}):(typeof e!="number"&&(e=C),{top:e,right:e,bottom:e,left:e})}S.parseSpacing=u;function w(e,C){var m=u(C.settings.margin,0);return e.pageSize().width-(m.left+m.right)}S.getPageAvailableWidth=w},796:function(E,S){var b=this&&this.__extends||function(){var w=function(e,C){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,d){m.__proto__=d}||function(m,d){for(var a in d)Object.prototype.hasOwnProperty.call(d,a)&&(m[a]=d[a])},w(e,C)};return function(e,C){if(typeof C!="function"&&C!==null)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");w(e,C);function m(){this.constructor=e}e.prototype=C===null?Object.create(C):(m.prototype=C.prototype,new m)}}();Object.defineProperty(S,"__esModule",{value:!0}),S.getTheme=S.defaultStyles=S.HtmlRowInput=void 0;var R=function(w){b(e,w);function e(C){var m=w.call(this)||this;return m._element=C,m}return e}(Array);S.HtmlRowInput=R;function v(w){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/w,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}S.defaultStyles=v;function u(w){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[w]}S.getTheme=u},903:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.parseCss=void 0;var R=b(420);function v(m,d,a,t,n){var s={},l=1.3333333333333333,i=w(d,function(g){return n.getComputedStyle(g).backgroundColor});i!=null&&(s.fillColor=i);var f=w(d,function(g){return n.getComputedStyle(g).color});f!=null&&(s.textColor=f);var p=C(t,a);p&&(s.cellPadding=p);var y="borderTopColor",c=l*a,o=t.borderTopWidth;if(t.borderBottomWidth===o&&t.borderRightWidth===o&&t.borderLeftWidth===o){var D=(parseFloat(o)||0)/c;D&&(s.lineWidth=D)}else s.lineWidth={top:(parseFloat(t.borderTopWidth)||0)/c,right:(parseFloat(t.borderRightWidth)||0)/c,bottom:(parseFloat(t.borderBottomWidth)||0)/c,left:(parseFloat(t.borderLeftWidth)||0)/c},s.lineWidth.top||(s.lineWidth.right?y="borderRightColor":s.lineWidth.bottom?y="borderBottomColor":s.lineWidth.left&&(y="borderLeftColor"));var z=w(d,function(g){return n.getComputedStyle(g)[y]});z!=null&&(s.lineColor=z);var j=["left","right","center","justify"];j.indexOf(t.textAlign)!==-1&&(s.halign=t.textAlign),j=["middle","bottom","top"],j.indexOf(t.verticalAlign)!==-1&&(s.valign=t.verticalAlign);var h=parseInt(t.fontSize||"");isNaN(h)||(s.fontSize=h/l);var r=u(t);r&&(s.fontStyle=r);var P=(t.fontFamily||"").toLowerCase();return m.indexOf(P)!==-1&&(s.font=P),s}S.parseCss=v;function u(m){var d="";return(m.fontWeight==="bold"||m.fontWeight==="bolder"||parseInt(m.fontWeight)>=700)&&(d="bold"),(m.fontStyle==="italic"||m.fontStyle==="oblique")&&(d+="italic"),d}function w(m,d){var a=e(m,d);if(!a)return null;var t=a.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!t||!Array.isArray(t))return null;var n=[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])],s=parseInt(t[4]);return s===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function e(m,d){var a=d(m);return a==="rgba(0, 0, 0, 0)"||a==="transparent"||a==="initial"||a==="inherit"?m.parentElement==null?null:e(m.parentElement,d):a}function C(m,d){var a=[m.paddingTop,m.paddingRight,m.paddingBottom,m.paddingLeft],t=96/(72/d),n=(parseInt(m.lineHeight)-parseInt(m.fontSize))/d/2,s=a.map(function(i){return parseInt(i||"0")/t}),l=(0,R.parseSpacing)(s,0);return n>l.top&&(l.top=n),n>l.bottom&&(l.bottom=n),l}},744:function(E,S){Object.defineProperty(S,"__esModule",{value:!0}),S.DocHandler=void 0;var b={},R=function(){function v(u){this.jsPDFDocument=u,this.userStyles={textColor:u.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:u.internal.getFontSize(),fontStyle:u.internal.getFont().fontStyle,font:u.internal.getFont().fontName,lineWidth:u.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:u.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return v.setDefaults=function(u,w){w===void 0&&(w=null),w?w.__autoTableDocumentDefaults=u:b=u},v.unifyColor=function(u){return Array.isArray(u)?u:typeof u=="number"?[u,u,u]:typeof u=="string"?[u]:null},v.prototype.applyStyles=function(u,w){var e,C,m;w===void 0&&(w=!1),u.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(u.fontStyle);var d=this.jsPDFDocument.internal.getFont(),a=d.fontStyle,t=d.fontName;if(u.font&&(t=u.font),u.fontStyle){a=u.fontStyle;var n=this.getFontList()[t];n&&n.indexOf(a)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(n[0]),a=n[0])}if(this.jsPDFDocument.setFont(t,a),u.fontSize&&this.jsPDFDocument.setFontSize(u.fontSize),!w){var s=v.unifyColor(u.fillColor);s&&(e=this.jsPDFDocument).setFillColor.apply(e,s),s=v.unifyColor(u.textColor),s&&(C=this.jsPDFDocument).setTextColor.apply(C,s),s=v.unifyColor(u.lineColor),s&&(m=this.jsPDFDocument).setDrawColor.apply(m,s),typeof u.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(u.lineWidth)}},v.prototype.splitTextToSize=function(u,w,e){return this.jsPDFDocument.splitTextToSize(u,w,e)},v.prototype.rect=function(u,w,e,C,m){return this.jsPDFDocument.rect(u,w,e,C,m)},v.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},v.prototype.getTextWidth=function(u){return this.jsPDFDocument.getTextWidth(u)},v.prototype.getDocument=function(){return this.jsPDFDocument},v.prototype.setPage=function(u){this.jsPDFDocument.setPage(u)},v.prototype.addPage=function(){return this.jsPDFDocument.addPage()},v.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},v.prototype.getGlobalOptions=function(){return b||{}},v.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},v.prototype.pageSize=function(){var u=this.jsPDFDocument.internal.pageSize;return u.width==null&&(u={width:u.getWidth(),height:u.getHeight()}),u},v.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},v.prototype.getLineHeightFactor=function(){var u=this.jsPDFDocument;return u.getLineHeightFactor?u.getLineHeightFactor():1.15},v.prototype.getLineHeight=function(u){return u/this.scaleFactor()*this.getLineHeightFactor()},v.prototype.pageNumber=function(){var u=this.jsPDFDocument.internal.getCurrentPageInfo();return u?u.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},v}();S.DocHandler=R},4:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.parseHtml=void 0;var R=b(903),v=b(796);function u(C,m,d,a,t){var n,s;a===void 0&&(a=!1),t===void 0&&(t=!1);var l;typeof m=="string"?l=d.document.querySelector(m):l=m;var i=Object.keys(C.getFontList()),f=C.scaleFactor(),p=[],y=[],c=[];if(!l)return console.error("Html table could not be found with input: ",m),{head:p,body:y,foot:c};for(var o=0;o<l.rows.length;o++){var D=l.rows[o],z=(s=(n=D==null?void 0:D.parentElement)===null||n===void 0?void 0:n.tagName)===null||s===void 0?void 0:s.toLowerCase(),j=w(i,f,d,D,a,t);j&&(z==="thead"?p.push(j):z==="tfoot"?c.push(j):y.push(j))}return{head:p,body:y,foot:c}}S.parseHtml=u;function w(C,m,d,a,t,n){for(var s=new v.HtmlRowInput(a),l=0;l<a.cells.length;l++){var i=a.cells[l],f=d.getComputedStyle(i);if(t||f.display!=="none"){var p=void 0;n&&(p=(0,R.parseCss)(C,i,m,f,d)),s.push({rowSpan:i.rowSpan,colSpan:i.colSpan,styles:p,_element:i,content:e(i)})}}var y=d.getComputedStyle(a);if(s.length>0&&(t||y.display!=="none"))return s}function e(C){var m=C.cloneNode(!0);return m.innerHTML=m.innerHTML.replace(/\n/g,"").replace(/ +/g," "),m.innerHTML=m.innerHTML.split(/<br.*?>/).map(function(d){return d.trim()}).join(`
`),m.innerText||m.textContent||""}},776:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.parseInput=void 0;var R=b(4),v=b(356),u=b(420),w=b(744),e=b(792);function C(l,i){var f=new w.DocHandler(l),p=f.getDocumentOptions(),y=f.getGlobalOptions();(0,e.default)(f,y,p,i);var c=(0,v.assign)({},y,p,i),o;typeof window<"u"&&(o=window);var D=m(y,p,i),z=d(y,p,i),j=a(f,c),h=n(f,c,o);return{id:i.tableId,content:h,hooks:z,styles:D,settings:j}}S.parseInput=C;function m(l,i,f){for(var p={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},y=function(z){if(z==="columnStyles"){var j=l[z],h=i[z],r=f[z];p.columnStyles=(0,v.assign)({},j,h,r)}else{var P=[l,i,f],g=P.map(function(F){return F[z]||{}});p[z]=(0,v.assign)({},g[0],g[1],g[2])}},c=0,o=Object.keys(p);c<o.length;c++){var D=o[c];y(D)}return p}function d(l,i,f){for(var p=[l,i,f],y={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},c=0,o=p;c<o.length;c++){var D=o[c];D.didParseCell&&y.didParseCell.push(D.didParseCell),D.willDrawCell&&y.willDrawCell.push(D.willDrawCell),D.didDrawCell&&y.didDrawCell.push(D.didDrawCell),D.willDrawPage&&y.willDrawPage.push(D.willDrawPage),D.didDrawPage&&y.didDrawPage.push(D.didDrawPage)}return y}function a(l,i){var f,p,y,c,o,D,z,j,h,r,P,g,F=(0,u.parseSpacing)(i.margin,40/l.scaleFactor()),H=(f=t(l,i.startY))!==null&&f!==void 0?f:F.top,_;i.showFoot===!0?_="everyPage":i.showFoot===!1?_="never":_=(p=i.showFoot)!==null&&p!==void 0?p:"everyPage";var x;i.showHead===!0?x="everyPage":i.showHead===!1?x="never":x=(y=i.showHead)!==null&&y!==void 0?y:"everyPage";var W=(c=i.useCss)!==null&&c!==void 0?c:!1,A=i.theme||(W?"plain":"striped"),k=!!i.horizontalPageBreak,M=(o=i.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(D=i.includeHiddenHtml)!==null&&D!==void 0?D:!1,useCss:W,theme:A,startY:H,margin:F,pageBreak:(z=i.pageBreak)!==null&&z!==void 0?z:"auto",rowPageBreak:(j=i.rowPageBreak)!==null&&j!==void 0?j:"auto",tableWidth:(h=i.tableWidth)!==null&&h!==void 0?h:"auto",showHead:x,showFoot:_,tableLineWidth:(r=i.tableLineWidth)!==null&&r!==void 0?r:0,tableLineColor:(P=i.tableLineColor)!==null&&P!==void 0?P:200,horizontalPageBreak:k,horizontalPageBreakRepeat:M,horizontalPageBreakBehaviour:(g=i.horizontalPageBreakBehaviour)!==null&&g!==void 0?g:"afterAllRows"}}function t(l,i){var f=l.getLastAutoTable(),p=l.scaleFactor(),y=l.pageNumber(),c=!1;if(f&&f.startPageNumber){var o=f.startPageNumber+f.pageNumber-1;c=o===y}return typeof i=="number"?i:(i==null||i===!1)&&c&&(f==null?void 0:f.finalY)!=null?f.finalY+20/p:null}function n(l,i,f){var p=i.head||[],y=i.body||[],c=i.foot||[];if(i.html){var o=i.includeHiddenHtml;if(f){var D=(0,R.parseHtml)(l,i.html,f,o,i.useCss)||{};p=D.head||p,y=D.body||p,c=D.foot||p}else console.error("Cannot parse html in non browser environment")}var z=i.columns||s(p,y,c);return{columns:z,head:p,body:y,foot:c}}function s(l,i,f){var p=l[0]||i[0]||f[0]||[],y=[];return Object.keys(p).filter(function(c){return c!=="_element"}).forEach(function(c){var o=1,D;Array.isArray(p)?D=p[parseInt(c)]:D=p[c],typeof D=="object"&&!Array.isArray(D)&&(o=(D==null?void 0:D.colSpan)||1);for(var z=0;z<o;z++){var j=void 0;Array.isArray(p)?j=y.length:j=c+(z>0?"_".concat(z):"");var h={dataKey:j};y.push(h)}}),y}},792:function(E,S){Object.defineProperty(S,"__esModule",{value:!0});function b(v,u,w,e){for(var C=function(t){t&&typeof t!="object"&&console.error("The options parameter should be of type object, is: "+typeof t),typeof t.extendWidth<"u"&&(t.tableWidth=t.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof t.margins<"u"&&(typeof t.margin>"u"&&(t.margin=t.margins),console.error("Use of deprecated option: margins, use margin instead.")),t.startY&&typeof t.startY!="number"&&(console.error("Invalid value for startY option",t.startY),delete t.startY),!t.didDrawPage&&(t.afterPageContent||t.beforePageContent||t.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),t.didDrawPage=function(c){v.applyStyles(v.userStyles),t.beforePageContent&&t.beforePageContent(c),v.applyStyles(v.userStyles),t.afterPageContent&&t.afterPageContent(c),v.applyStyles(v.userStyles),t.afterPageAdd&&c.pageNumber>1&&c.afterPageAdd(c),v.applyStyles(v.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(c){t[c]&&console.error('The "'.concat(c,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(c){var o=c[0],D=c[1];t[D]&&(console.error("Use of deprecated option ".concat(D,". Use ").concat(o," instead")),t[o]=t[D])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(c){var o=typeof c=="string"?c:c[0],D=typeof c=="string"?c:c[1];typeof t[o]<"u"&&(typeof t.styles[D]>"u"&&(t.styles[D]=t[o]),console.error("Use of deprecated option: "+o+", use the style "+D+" instead."))});for(var n=0,s=["styles","bodyStyles","headStyles","footStyles"];n<s.length;n++){var l=s[n];R(t[l]||{})}for(var i=t.columnStyles||{},f=0,p=Object.keys(i);f<p.length;f++){var y=p[f];R(i[y]||{})}},m=0,d=[u,w,e];m<d.length;m++){var a=d[m];C(a)}}S.default=b;function R(v){v.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),v.minCellHeight||(v.minCellHeight=v.rowHeight)):v.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),v.cellWidth||(v.cellWidth=v.columnWidth))}},260:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.Column=S.Cell=S.Row=S.Table=void 0;var R=b(796),v=b(172),u=b(420),w=function(){function d(a,t){this.pageNumber=1,this.pageCount=1,this.id=a.id,this.settings=a.settings,this.styles=a.styles,this.hooks=a.hooks,this.columns=t.columns,this.head=t.head,this.body=t.body,this.foot=t.foot}return d.prototype.getHeadHeight=function(a){return this.head.reduce(function(t,n){return t+n.getMaxCellHeight(a)},0)},d.prototype.getFootHeight=function(a){return this.foot.reduce(function(t,n){return t+n.getMaxCellHeight(a)},0)},d.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},d.prototype.callCellHooks=function(a,t,n,s,l,i){for(var f=0,p=t;f<p.length;f++){var y=p[f],c=new v.CellHookData(a,this,n,s,l,i),o=y(c)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],o)return!1}return!0},d.prototype.callEndPageHooks=function(a,t){a.applyStyles(a.userStyles);for(var n=0,s=this.hooks.didDrawPage;n<s.length;n++){var l=s[n];l(new v.HookData(a,this,t))}},d.prototype.callWillDrawPageHooks=function(a,t){for(var n=0,s=this.hooks.willDrawPage;n<s.length;n++){var l=s[n];l(new v.HookData(a,this,t))}},d.prototype.getWidth=function(a){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var t=this.columns.reduce(function(s,l){return s+l.wrappedWidth},0);return t}else{var n=this.settings.margin;return a-n.left-n.right}},d}();S.Table=w;var e=function(){function d(a,t,n,s,l){l===void 0&&(l=!1),this.height=0,this.raw=a,a instanceof R.HtmlRowInput&&(this.raw=a._element,this.element=a._element),this.index=t,this.section=n,this.cells=s,this.spansMultiplePages=l}return d.prototype.getMaxCellHeight=function(a){var t=this;return a.reduce(function(n,s){var l;return Math.max(n,((l=t.cells[s.index])===null||l===void 0?void 0:l.height)||0)},0)},d.prototype.hasRowSpan=function(a){var t=this;return a.filter(function(n){var s=t.cells[n.index];return s?s.rowSpan>1:!1}).length>0},d.prototype.canEntireRowFit=function(a,t){return this.getMaxCellHeight(t)<=a},d.prototype.getMinimumRowHeight=function(a,t){var n=this;return a.reduce(function(s,l){var i=n.cells[l.index];if(!i)return 0;var f=t.getLineHeight(i.styles.fontSize),p=i.padding("vertical"),y=p+f;return y>s?y:s},0)},d}();S.Row=e;var C=function(){function d(a,t,n){var s,l;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=t,this.section=n,this.raw=a;var i=a;a!=null&&typeof a=="object"&&!Array.isArray(a)?(this.rowSpan=a.rowSpan||1,this.colSpan=a.colSpan||1,i=(l=(s=a.content)!==null&&s!==void 0?s:a.title)!==null&&l!==void 0?l:a,a._element&&(this.raw=a._element)):(this.rowSpan=1,this.colSpan=1);var f=i!=null?""+i:"",p=/\r\n|\r|\n/g;this.text=f.split(p)}return d.prototype.getTextPos=function(){var a;if(this.styles.valign==="top")a=this.y+this.padding("top");else if(this.styles.valign==="bottom")a=this.y+this.height-this.padding("bottom");else{var t=this.height-this.padding("vertical");a=this.y+t/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var s=this.width-this.padding("horizontal");n=this.x+s/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:a}},d.prototype.getContentHeight=function(a,t){t===void 0&&(t=1.15);var n=Array.isArray(this.text)?this.text.length:1,s=this.styles.fontSize/a*t,l=n*s+this.padding("vertical");return Math.max(l,this.styles.minCellHeight)},d.prototype.padding=function(a){var t=(0,u.parseSpacing)(this.styles.cellPadding,0);return a==="vertical"?t.top+t.bottom:a==="horizontal"?t.left+t.right:t[a]},d}();S.Cell=C;var m=function(){function d(a,t,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=a,this.raw=t,this.index=n}return d.prototype.getMaxCustomCellWidth=function(a){for(var t=0,n=0,s=a.allRows();n<s.length;n++){var l=s[n],i=l.cells[this.index];i&&typeof i.styles.cellWidth=="number"&&(t=Math.max(t,i.styles.cellWidth))}return t},d}();S.Column=m},356:function(E,S){Object.defineProperty(S,"__esModule",{value:!0}),S.assign=void 0;function b(R,v,u,w,e){if(R==null)throw new TypeError("Cannot convert undefined or null to object");for(var C=Object(R),m=1;m<arguments.length;m++){var d=arguments[m];if(d!=null)for(var a in d)Object.prototype.hasOwnProperty.call(d,a)&&(C[a]=d[a])}return C}S.assign=b},972:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.createTable=void 0;var R=b(744),v=b(260),u=b(324),w=b(796),e=b(356);function C(l,i){var f=new R.DocHandler(l),p=m(i,f.scaleFactor()),y=new v.Table(i,p);return(0,u.calculateWidths)(f,y),f.applyStyles(f.userStyles),y}S.createTable=C;function m(l,i){var f=l.content,p=n(f.columns);if(f.head.length===0){var y=a(p,"head");y&&f.head.push(y)}if(f.foot.length===0){var y=a(p,"foot");y&&f.foot.push(y)}var c=l.settings.theme,o=l.styles;return{columns:p,head:d("head",f.head,p,o,c,i),body:d("body",f.body,p,o,c,i),foot:d("foot",f.foot,p,o,c,i)}}function d(l,i,f,p,y,c){var o={},D=i.map(function(z,j){for(var h=0,r={},P=0,g=0,F=0,H=f;F<H.length;F++){var _=H[F];if(o[_.index]==null||o[_.index].left===0)if(g===0){var x=void 0;Array.isArray(z)?x=z[_.index-P-h]:x=z[_.dataKey];var W={};typeof x=="object"&&!Array.isArray(x)&&(W=(x==null?void 0:x.styles)||{});var A=s(l,_,j,y,p,c,W),k=new v.Cell(x,A,l);r[_.dataKey]=k,r[_.index]=k,g=k.colSpan-1,o[_.index]={left:k.rowSpan-1,times:g}}else g--,P++;else o[_.index].left--,g=o[_.index].times,h++}return new v.Row(z,j,l,r)});return D}function a(l,i){var f={};return l.forEach(function(p){if(p.raw!=null){var y=t(i,p.raw);y!=null&&(f[p.dataKey]=y)}}),Object.keys(f).length>0?f:null}function t(l,i){if(l==="head"){if(typeof i=="object")return i.header||i.title||null;if(typeof i=="string"||typeof i=="number")return i}else if(l==="foot"&&typeof i=="object")return i.footer;return null}function n(l){return l.map(function(i,f){var p,y,c;return typeof i=="object"?c=(y=(p=i.dataKey)!==null&&p!==void 0?p:i.key)!==null&&y!==void 0?y:f:c=f,new v.Column(c,i,f)})}function s(l,i,f,p,y,c,o){var D=(0,w.getTheme)(p),z;l==="head"?z=y.headStyles:l==="body"?z=y.bodyStyles:l==="foot"&&(z=y.footStyles);var j=(0,e.assign)({},D.table,D[l],y.styles,z),h=y.columnStyles[i.dataKey]||y.columnStyles[i.index]||{},r=l==="body"?h:{},P=l==="body"&&f%2===0?(0,e.assign)({},D.alternateRow,y.alternateRowStyles):{},g=(0,w.defaultStyles)(c),F=(0,e.assign)({},g,j,P,r);return(0,e.assign)(F,o)}},664:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.addPage=S.drawTable=void 0;var R=b(420),v=b(260),u=b(744),w=b(356),e=b(136),C=b(224);function m(h,r){var P=r.settings,g=P.startY,F=P.margin,H={x:F.left,y:g},_=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns),x=g+F.bottom+_;if(P.pageBreak==="avoid"){var W=r.body,A=W.reduce(function(B,O){return B+O.height},0);x+=A}var k=new u.DocHandler(h);(P.pageBreak==="always"||P.startY!=null&&x>k.pageSize().height)&&(j(k),H.y=F.top),r.callWillDrawPageHooks(k,H);var M=(0,w.assign)({},H);r.startPageNumber=k.pageNumber(),P.horizontalPageBreak?d(k,r,M,H):(k.applyStyles(k.userStyles),(P.showHead==="firstPage"||P.showHead==="everyPage")&&r.head.forEach(function(B){return y(k,r,B,H,r.columns)}),k.applyStyles(k.userStyles),r.body.forEach(function(B,O){var G=O===r.body.length-1;p(k,r,B,G,M,H,r.columns)}),k.applyStyles(k.userStyles),(P.showFoot==="lastPage"||P.showFoot==="everyPage")&&r.foot.forEach(function(B){return y(k,r,B,H,r.columns)})),(0,R.addTableBorder)(k,r,M,H),r.callEndPageHooks(k,H),r.finalY=H.y,h.lastAutoTable=r,h.previousAutoTable=r,h.autoTable&&(h.autoTable.previous=r),k.applyStyles(k.userStyles)}S.drawTable=m;function d(h,r,P,g){var F=(0,C.calculateAllColumnsCanFitInPage)(h,r),H=r.settings;if(H.horizontalPageBreakBehaviour==="afterAllRows")F.forEach(function(A,k){h.applyStyles(h.userStyles),k>0?z(h,r,P,g,A.columns,!0):a(h,r,g,A.columns),t(h,r,P,g,A.columns),s(h,r,g,A.columns)});else for(var _=-1,x=F[0],W=function(){var A=_;if(x){h.applyStyles(h.userStyles);var k=x.columns;_>=0?z(h,r,P,g,k,!0):a(h,r,g,k),A=n(h,r,_+1,g,k),s(h,r,g,k)}var M=A-_;F.slice(1).forEach(function(B){h.applyStyles(h.userStyles),z(h,r,P,g,B.columns,!0),n(h,r,_+1,g,B.columns,M),s(h,r,g,B.columns)}),_=A};_<r.body.length-1;)W()}function a(h,r,P,g){var F=r.settings;h.applyStyles(h.userStyles),(F.showHead==="firstPage"||F.showHead==="everyPage")&&r.head.forEach(function(H){return y(h,r,H,P,g)})}function t(h,r,P,g,F){h.applyStyles(h.userStyles),r.body.forEach(function(H,_){var x=_===r.body.length-1;p(h,r,H,x,P,g,F)})}function n(h,r,P,g,F,H){h.applyStyles(h.userStyles),H=H??r.body.length;var _=Math.min(P+H,r.body.length),x=-1;return r.body.slice(P,_).forEach(function(W,A){var k=P+A===r.body.length-1,M=D(h,r,k,g);W.canEntireRowFit(M,F)&&(y(h,r,W,g,F),x=P+A)}),x}function s(h,r,P,g){var F=r.settings;h.applyStyles(h.userStyles),(F.showFoot==="lastPage"||F.showFoot==="everyPage")&&r.foot.forEach(function(H){return y(h,r,H,P,g)})}function l(h,r,P){var g=P.getLineHeight(h.styles.fontSize),F=h.padding("vertical"),H=Math.floor((r-F)/g);return Math.max(0,H)}function i(h,r,P,g){var F={};h.spansMultiplePages=!0,h.height=0;for(var H=0,_=0,x=P.columns;_<x.length;_++){var W=x[_],A=h.cells[W.index];if(A){Array.isArray(A.text)||(A.text=[A.text]);var k=new v.Cell(A.raw,A.styles,A.section);k=(0,w.assign)(k,A),k.text=[];var M=l(A,r,g);A.text.length>M&&(k.text=A.text.splice(M,A.text.length));var B=g.scaleFactor(),O=g.getLineHeightFactor();A.contentHeight=A.getContentHeight(B,O),A.contentHeight>=r&&(A.contentHeight=r,k.styles.minCellHeight-=r),A.contentHeight>h.height&&(h.height=A.contentHeight),k.contentHeight=k.getContentHeight(B,O),k.contentHeight>H&&(H=k.contentHeight),F[W.index]=k}}var G=new v.Row(h.raw,-1,h.section,F,!0);G.height=H;for(var K=0,q=P.columns;K<q.length;K++){var W=q[K],k=G.cells[W.index];k&&(k.height=G.height);var A=h.cells[W.index];A&&(A.height=h.height)}return G}function f(h,r,P,g){var F=h.pageSize().height,H=g.settings.margin,_=H.top+H.bottom,x=F-_;r.section==="body"&&(x-=g.getHeadHeight(g.columns)+g.getFootHeight(g.columns));var W=r.getMinimumRowHeight(g.columns,h),A=W<P;if(W>x)return console.error("Will not be able to print row ".concat(r.index," correctly since it's minimum height is larger than page height")),!0;if(!A)return!1;var k=r.hasRowSpan(g.columns),M=r.getMaxCellHeight(g.columns)>x;return M?(k&&console.error("The content of row ".concat(r.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(k||g.settings.rowPageBreak==="avoid")}function p(h,r,P,g,F,H,_){var x=D(h,r,g,H);if(P.canEntireRowFit(x,_))y(h,r,P,H,_);else if(f(h,P,x,r)){var W=i(P,x,r,h);y(h,r,P,H,_),z(h,r,F,H,_),p(h,r,W,g,F,H,_)}else z(h,r,F,H,_),p(h,r,P,g,F,H,_)}function y(h,r,P,g,F){g.x=r.settings.margin.left;for(var H=0,_=F;H<_.length;H++){var x=_[H],W=P.cells[x.index];if(!W){g.x+=x.width;continue}h.applyStyles(W.styles),W.x=g.x,W.y=g.y;var A=r.callCellHooks(h,r.hooks.willDrawCell,W,P,x,g);if(A===!1){g.x+=x.width;continue}c(h,W,g);var k=W.getTextPos();(0,e.default)(W.text,k.x,k.y,{halign:W.styles.halign,valign:W.styles.valign,maxWidth:Math.ceil(W.width-W.padding("left")-W.padding("right"))},h.getDocument()),r.callCellHooks(h,r.hooks.didDrawCell,W,P,x,g),g.x+=x.width}g.y+=P.height}function c(h,r,P){var g=r.styles;if(h.getDocument().setFillColor(h.getDocument().getFillColor()),typeof g.lineWidth=="number"){var F=(0,R.getFillStyle)(g.lineWidth,g.fillColor);F&&h.rect(r.x,P.y,r.width,r.height,F)}else typeof g.lineWidth=="object"&&(g.fillColor&&h.rect(r.x,P.y,r.width,r.height,"F"),o(h,r,P,g.lineWidth))}function o(h,r,P,g){var F,H,_,x;g.top&&(F=P.x,H=P.y,_=P.x+r.width,x=P.y,g.right&&(_+=.5*g.right),g.left&&(F-=.5*g.left),W(g.top,F,H,_,x)),g.bottom&&(F=P.x,H=P.y+r.height,_=P.x+r.width,x=P.y+r.height,g.right&&(_+=.5*g.right),g.left&&(F-=.5*g.left),W(g.bottom,F,H,_,x)),g.left&&(F=P.x,H=P.y,_=P.x,x=P.y+r.height,g.top&&(H-=.5*g.top),g.bottom&&(x+=.5*g.bottom),W(g.left,F,H,_,x)),g.right&&(F=P.x+r.width,H=P.y,_=P.x+r.width,x=P.y+r.height,g.top&&(H-=.5*g.top),g.bottom&&(x+=.5*g.bottom),W(g.right,F,H,_,x));function W(A,k,M,B,O){h.getDocument().setLineWidth(A),h.getDocument().line(k,M,B,O,"S")}}function D(h,r,P,g){var F=r.settings.margin.bottom,H=r.settings.showFoot;return(H==="everyPage"||H==="lastPage"&&P)&&(F+=r.getFootHeight(r.columns)),h.pageSize().height-g.y-F}function z(h,r,P,g,F,H){F===void 0&&(F=[]),H===void 0&&(H=!1),h.applyStyles(h.userStyles),r.settings.showFoot==="everyPage"&&!H&&r.foot.forEach(function(x){return y(h,r,x,g,F)}),r.callEndPageHooks(h,g);var _=r.settings.margin;(0,R.addTableBorder)(h,r,P,g),j(h),r.pageNumber++,r.pageCount++,g.x=_.left,g.y=_.top,P.y=_.top,r.callWillDrawPageHooks(h,g),r.settings.showHead==="everyPage"&&(r.head.forEach(function(x){return y(h,r,x,g,F)}),h.applyStyles(h.userStyles))}S.addPage=z;function j(h){var r=h.pageNumber();h.setPage(r+1);var P=h.pageNumber();return P===r?(h.addPage(),!0):!1}},224:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.calculateAllColumnsCanFitInPage=void 0;var R=b(420);function v(w,e,C){var m;C===void 0&&(C={});var d=(0,R.getPageAvailableWidth)(w,e),a=new Map,t=[],n=[],s=[];e.settings.horizontalPageBreakRepeat,Array.isArray(e.settings.horizontalPageBreakRepeat)?s=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(s=[e.settings.horizontalPageBreakRepeat]),s.forEach(function(p){var y=e.columns.find(function(c){return c.dataKey===p||c.index===p});y&&!a.has(y.index)&&(a.set(y.index,!0),t.push(y.index),n.push(e.columns[y.index]),d-=y.wrappedWidth)});for(var l=!0,i=(m=C==null?void 0:C.start)!==null&&m!==void 0?m:0;i<e.columns.length;){if(a.has(i)){i++;continue}var f=e.columns[i].wrappedWidth;if(l||d>=f)l=!1,t.push(i),n.push(e.columns[i]),d-=f;else break;i++}return{colIndexes:t,columns:n,lastIndex:i-1}}function u(w,e){for(var C=[],m=0;m<e.columns.length;m++){var d=v(w,e,{start:m});d.columns.length&&(C.push(d),m=d.lastIndex)}return C}S.calculateAllColumnsCanFitInPage=u},324:function(E,S,b){Object.defineProperty(S,"__esModule",{value:!0}),S.ellipsize=S.resizeColumns=S.calculateWidths=void 0;var R=b(420);function v(t,n){u(t,n);var s=[],l=0;n.columns.forEach(function(f){var p=f.getMaxCustomCellWidth(n);p?f.width=p:(f.width=f.wrappedWidth,s.push(f)),l+=f.width});var i=n.getWidth(t.pageSize().width)-l;i&&(i=w(s,i,function(f){return Math.max(f.minReadableWidth,f.minWidth)})),i&&(i=w(s,i,function(f){return f.minWidth})),i=Math.abs(i),!n.settings.horizontalPageBreak&&i>.1/t.scaleFactor()&&(i=i<1?i:Math.round(i),console.warn("Of the table content, ".concat(i," units width could not fit page"))),C(n),m(n,t),e(n)}S.calculateWidths=v;function u(t,n){var s=t.scaleFactor(),l=n.settings.horizontalPageBreak,i=(0,R.getPageAvailableWidth)(t,n);n.allRows().forEach(function(f){for(var p=0,y=n.columns;p<y.length;p++){var c=y[p],o=f.cells[c.index];if(o){var D=n.hooks.didParseCell;n.callCellHooks(t,D,o,f,c,null);var z=o.padding("horizontal");o.contentWidth=(0,R.getStringWidth)(o.text,o.styles,t)+z;var j=(0,R.getStringWidth)(o.text.join(" ").split(/[^\S\u00A0]+/),o.styles,t);if(o.minReadableWidth=j+o.padding("horizontal"),typeof o.styles.cellWidth=="number")o.minWidth=o.styles.cellWidth,o.wrappedWidth=o.styles.cellWidth;else if(o.styles.cellWidth==="wrap"||l===!0)o.contentWidth>i?(o.minWidth=i,o.wrappedWidth=i):(o.minWidth=o.contentWidth,o.wrappedWidth=o.contentWidth);else{var h=10/s;o.minWidth=o.styles.minCellWidth||h,o.wrappedWidth=o.contentWidth,o.minWidth>o.wrappedWidth&&(o.wrappedWidth=o.minWidth)}}}}),n.allRows().forEach(function(f){for(var p=0,y=n.columns;p<y.length;p++){var c=y[p],o=f.cells[c.index];if(o&&o.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,o.wrappedWidth),c.minWidth=Math.max(c.minWidth,o.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,o.minReadableWidth);else{var D=n.styles.columnStyles[c.dataKey]||n.styles.columnStyles[c.index]||{},z=D.cellWidth||D.minCellWidth;z&&typeof z=="number"&&(c.minWidth=z,c.wrappedWidth=z)}o&&(o.colSpan>1&&!c.minWidth&&(c.minWidth=o.minWidth),o.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=o.minWidth))}})}function w(t,n,s){for(var l=n,i=t.reduce(function(h,r){return h+r.wrappedWidth},0),f=0;f<t.length;f++){var p=t[f],y=p.wrappedWidth/i,c=l*y,o=p.width+c,D=s(p),z=o<D?D:o;n-=z-p.width,p.width=z}if(n=Math.round(n*1e10)/1e10,n){var j=t.filter(function(h){return n<0?h.width>s(h):!0});j.length&&(n=w(j,n,s))}return n}S.resizeColumns=w;function e(t){for(var n={},s=1,l=t.allRows(),i=0;i<l.length;i++)for(var f=l[i],p=0,y=t.columns;p<y.length;p++){var c=y[p],o=n[c.index];if(s>1)s--,delete f.cells[c.index];else if(o)o.cell.height+=f.height,s=o.cell.colSpan,delete f.cells[c.index],o.left--,o.left<=1&&delete n[c.index];else{var D=f.cells[c.index];if(!D)continue;if(D.height=f.height,D.rowSpan>1){var z=l.length-i,j=D.rowSpan>z?z:D.rowSpan;n[c.index]={cell:D,left:j,row:f}}}}}function C(t){for(var n=t.allRows(),s=0;s<n.length;s++)for(var l=n[s],i=null,f=0,p=0,y=0;y<t.columns.length;y++){var c=t.columns[y];if(p-=1,p>1&&t.columns[y+1])f+=c.width,delete l.cells[c.index];else if(i){var o=i;delete l.cells[c.index],i=null,o.width=c.width+f}else{var o=l.cells[c.index];if(!o)continue;if(p=o.colSpan,f=0,o.colSpan>1){i=o,f+=c.width;continue}o.width=c.width+f}}}function m(t,n){for(var s={count:0,height:0},l=0,i=t.allRows();l<i.length;l++){for(var f=i[l],p=0,y=t.columns;p<y.length;p++){var c=y[p],o=f.cells[c.index];if(o){n.applyStyles(o.styles,!0);var D=o.width-o.padding("horizontal");if(o.styles.overflow==="linebreak")o.text=n.splitTextToSize(o.text,D+1/n.scaleFactor(),{fontSize:o.styles.fontSize});else if(o.styles.overflow==="ellipsize")o.text=d(o.text,D,o.styles,n,"...");else if(o.styles.overflow==="hidden")o.text=d(o.text,D,o.styles,n,"");else if(typeof o.styles.overflow=="function"){var z=o.styles.overflow(o.text,D);typeof z=="string"?o.text=[z]:o.text=z}o.contentHeight=o.getContentHeight(n.scaleFactor(),n.getLineHeightFactor());var j=o.contentHeight/o.rowSpan;o.rowSpan>1&&s.count*s.height<j*o.rowSpan?s={height:j,count:o.rowSpan}:s&&s.count>0&&s.height>j&&(j=s.height),j>f.height&&(f.height=j)}}s.count--}}function d(t,n,s,l,i){return t.map(function(f){return a(f,n,s,l,i)})}S.ellipsize=d;function a(t,n,s,l,i){var f=1e4*l.scaleFactor();if(n=Math.ceil(n*f)/f,n>=(0,R.getStringWidth)(t,s,l))return t;for(;n<(0,R.getStringWidth)(t+i,s,l)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+i}},964:function(E){if(typeof N>"u"){var S=new Error("Cannot find module 'undefined'");throw S.code="MODULE_NOT_FOUND",S}E.exports=N}},T={};function I(E){var S=T[E];if(S!==void 0)return S.exports;var b=T[E]={exports:{}};return L[E].call(b.exports,b,b.exports,I),b.exports}var Y={};return function(){var E=Y;Object.defineProperty(E,"__esModule",{value:!0}),E.Cell=E.Column=E.Row=E.Table=E.CellHookData=E.__drawTable=E.__createTable=E.applyPlugin=void 0;var S=I(340),b=I(776),R=I(664),v=I(972),u=I(260);Object.defineProperty(E,"Table",{enumerable:!0,get:function(){return u.Table}});var w=I(172);Object.defineProperty(E,"CellHookData",{enumerable:!0,get:function(){return w.CellHookData}});var e=I(260);Object.defineProperty(E,"Cell",{enumerable:!0,get:function(){return e.Cell}}),Object.defineProperty(E,"Column",{enumerable:!0,get:function(){return e.Column}}),Object.defineProperty(E,"Row",{enumerable:!0,get:function(){return e.Row}});function C(n){(0,S.default)(n)}E.applyPlugin=C;function m(n,s){var l=(0,b.parseInput)(n,s),i=(0,v.createTable)(n,l);(0,R.drawTable)(n,i)}function d(n,s){var l=(0,b.parseInput)(n,s);return(0,v.createTable)(n,l)}E.__createTable=d;function a(n,s){(0,R.drawTable)(n,s)}E.__drawTable=a;try{var t=I(964);t.jsPDF&&(t=t.jsPDF),C(t)}catch{}E.default=m}(),Y}()})})(at);var ht=at.exports;const Z=st(ht);nt.register(...lt);const gt=(U,Q)=>new Promise(N=>{const L=document.createElement("canvas");L.width=1e3,L.height=1e3;const T=L.getContext("2d");if(!T){N("");return}T.fillStyle="#FFFFFF",T.fillRect(0,0,L.width,L.height);const I=["cacao","acidity","bitterness","astringency","fresh_fruit","browned_fruit","vegetal","floral","woody","spice","nutty","caramel","sweetness","defects","roast"],Y=(u,w)=>X[u]?Q==="es"?X[u].es.toUpperCase():X[u].en.toUpperCase():w?Q==="es"?w.nameEs.toUpperCase():w.nameEn.toUpperCase():u.toUpperCase(),E=I.map(u=>{const w=U.find(e=>e.id===u);return Y(u,w)}),S=I.map(u=>{const w=U.find(e=>e.id===u);return w?w.score:0}),b=I.map(u=>V(u)),R={id:"custom_white_bg",beforeDraw:u=>{const{ctx:w,width:e,height:C}=u;w.save(),w.fillStyle="#FFFFFF",w.fillRect(0,0,e,C),w.restore()}},v=new nt(T,{type:"polarArea",data:{labels:E,datasets:[{data:S,backgroundColor:b,borderWidth:2,borderColor:"#ffffff"}]},options:{responsive:!1,animation:!1,layout:{padding:5},scales:{r:{min:0,max:10,ticks:{stepSize:2,z:1,backdropColor:"white",color:"#8c5e4a",font:{size:24}},grid:{color:"#eaddd7",circular:!0},angleLines:{display:!0,color:"#eaddd7"},pointLabels:{display:!0,centerPointLabels:!0,font:{size:20,family:"sans-serif",weight:"bold"},color:"#4a2e24",padding:10}}},plugins:{legend:{display:!1}}},plugins:[R]});setTimeout(()=>{const u=document.createElement("canvas");u.width=L.width,u.height=L.height;const w=u.getContext("2d");if(w){w.fillStyle="#FFFFFF",w.fillRect(0,0,u.width,u.height),w.drawImage(L,0,0);const e=u.toDataURL("image/jpeg",.9);v.destroy(),N(e)}else{const e=L.toDataURL("image/jpeg",.9);v.destroy(),N(e)}},100)}),bt=async(U,Q,N)=>{var Y,E;const L=Array.isArray(U)?U:[U];if(L.length===0)return;const T=new rt;for(let S=0;S<L.length;S++){const b=L[S];S>0&&T.addPage();const R=b.language==="es",v=(a,t)=>R?t:a;let u=Q;(!u||L.length>1)&&(u=await gt(b.attributes,b.language)),T.setFontSize(18),T.setTextColor(74,46,36),T.text(v("Cacao of Excellence - Sensory Evaluation","Cacao de Excelencia - Evaluación Sensorial"),14,20);const w=[[v("Evaluator","Evaluador"),b.metadata.evaluator||"-"],[v("Sample Code","Código de Muestra"),b.metadata.sampleCode||"-"],[v("Date","Fecha"),ft(b.metadata.date,b.language)||"-"],[v("Time","Hora"),b.metadata.time||"-"],[v("Type","Tipo"),b.metadata.evaluationType==="cacao_mass"?v("Cacao Mass","Masa de Cacao"):v("Chocolate","Chocolate")],[v("Sample Info","Info Muestra"),b.metadata.sampleInfo||"-"]];Z(T,{startY:30,body:w,theme:"striped",headStyles:{fillColor:[117,74,41]},styles:{fontSize:10,cellPadding:3},columnStyles:{0:{fontStyle:"bold",cellWidth:50}}});let e=T.lastAutoTable.finalY+10;T.setFontSize(12),T.setTextColor(74,46,36),T.setFont("helvetica","bold"),T.text(`${v("Global Quality Score","Calidad Global")}: ${b.globalQuality}/10`,14,e),e+=7,T.setFontSize(11),T.setFont("helvetica","normal");let C="-";if(b.selectedQualityId){const a=$.find(t=>t.id===b.selectedQualityId);a&&(C=R?a.nameEs:a.nameEn)}if(T.text(`${v("Additional Positive Qualities","Cualidades positivas adicionales")}: ${C}`,14,e),e+=10,u){const a=T.internal.pageSize.getWidth(),t=140,n=140,s=(a-t)/2;e+n>270&&(T.addPage(),e=20),T.addImage(u,"JPEG",s,e,t,n),e+=n+10}const m=b.attributes.map(a=>{var s;const t=R?a.nameEs:a.nameEn,n=(s=a.subAttributes)==null?void 0:s.filter(l=>l.score>0).map(l=>`${R?l.nameEs:l.nameEn}: ${l.score}`).join(", ");return[t,a.score.toString(),n||""]});Z(T,{startY:e,head:[[v("Attribute","Atributo"),{content:v("Score","Puntaje"),styles:{halign:"center"}},v("Descriptors","Descriptores")]],body:m,theme:"grid",headStyles:{fillColor:[117,74,41]},columnStyles:{0:{fontStyle:"bold",cellWidth:50},1:{halign:"center",cellWidth:25}},styles:{fontSize:9}}),e=T.lastAutoTable.finalY+10;const d=(a,t)=>{if(!t)return;e>260&&(T.addPage(),e=20),T.setFontSize(11),T.setFont("helvetica","bold"),T.setTextColor(0,0,0),T.text(a,14,e),e+=6,T.setFontSize(10),T.setFont("helvetica","normal");const n=T.splitTextToSize(t,180);T.text(n,14,e),e+=n.length*5+8};if(d(v("Judge's Notes","Notas del Juez"),b.metadata.notes),d(v("Producer Recommendations","Recomendaciones al Productor"),b.metadata.producerRecommendations),b.tdsProfile&&((Y=b.tdsProfile.events)==null?void 0:Y.length)>0){e>230&&(T.addPage(),e=20),e+=10,T.setFontSize(14),T.setFont("helvetica","bold"),T.setTextColor(74,46,36),T.text(v("TDS Analysis","Análisis TDS"),14,e),e+=8;const a=b.tdsProfile;let t=b.tdsProfile.analysis;if(!t)try{t=et(a)}catch(F){console.error("TDS Analysis failed for PDF",F)}T.setFontSize(10),T.setFont("helvetica","normal"),T.setTextColor(0,0,0);const n=v("Total Duration","Duración Total"),s=v("Swallow","Tragado"),l=v("Mode","Modo"),i=a.mode==="expert"?R?"Experto":"Expert":"Normal",f=a.swallowTime;if(T.text(`${n}: ${a.totalDuration.toFixed(1)}s`,14,e),T.text(`${s}: ${f.toFixed(1)}s`,80,e),T.text(`${l}: ${i}`,150,e),e+=6,t){const F=t.firstOnset||0,H=a.totalDuration-f,_=v("First Flavor Onset","Primer Sabor"),x=v("Aftertaste Duration","Duración Post-gusto");T.text(`${_}: ${F.toFixed(1)}s`,14,e),T.text(`${x}: ${H.toFixed(1)}s`,80,e)}e+=12;const p=14,y=180,c=20,o=y/(a.totalDuration||1),D=(t==null?void 0:t.firstOnset)||0,z=D+((t==null?void 0:t.attackPhaseDuration)||0),j=f,h=a.totalDuration,r=p+D*o,P=p+z*o,g=p+j*o;if(T.setFontSize(7),T.setTextColor(80),T.text("0%",r,e-6,{align:"center"}),T.text("20%",P,e-6,{align:"center"}),T.setFont("helvetica","bold"),T.text("100%",g,e-6,{align:"center"}),T.setFont("helvetica","normal"),T.setDrawColor(200),T.setFillColor(245,245,245),T.rect(p,e,y,c,"FD"),a.events.forEach(F=>{const H=p+F.start*o,_=(F.end-F.start)*o;if(_<.2)return;const x=V(F.attrId);T.setFillColor(x),T.rect(H,e,_,c,"F")}),t&&t.attackPhaseDuration>0&&(T.setDrawColor(100),T.setLineWidth(.5),T.setLineDashPattern([1,1],0),T.line(P,e-2,P,e+c+2),T.setLineDashPattern([],0)),j>0&&(T.setDrawColor(0),T.setLineWidth(.8),T.line(g,e-2,g,e+c+2)),e+=c,T.setFontSize(7),T.setTextColor(80),T.text(`${D.toFixed(1)}s`,r,e+5,{align:"center"}),T.text(`${z.toFixed(1)}s`,P,e+5,{align:"center"}),T.setFont("helvetica","bold"),T.text(`${j.toFixed(1)}s`,g,e+5,{align:"center"}),T.setFont("helvetica","normal"),T.text(`${h.toFixed(1)}s`,p+y,e+5,{align:"right"}),e+=15,t&&t.scores){e+=5;let F=[];t.scores instanceof Map?F=Array.from(t.scores.entries()):F=Object.entries(t.scores);const H=F.filter(([x,W])=>W.durationPercent>0).sort((x,W)=>{const A=tt.findIndex(O=>O.id===x[0]),k=tt.findIndex(O=>O.id===W[0]);return(A===-1?999:A)-(k===-1?999:k)}),_=H.map(([x,W])=>{const A=b.attributes.find(O=>O.id===x)||$.find(O=>O.id===x);let k=x;A?k=R?A.nameEs:A.nameEn:k=x.charAt(0).toUpperCase()+x.slice(1).replace("_"," ");const B=W.originalScore!==void 0&&W.originalScore<W.score?`${W.score} (*)`:W.score.toString();return["",k,`${W.durationPercent.toFixed(1)}%`,B]});if(Z(T,{startY:e,head:[["",v("TDS Attribute","Atributo TDS"),{content:v("Dominance %","Dominancia %"),styles:{halign:"center"}},{content:v("CoEx Score","Puntaje CoEx"),styles:{halign:"center"}}]],body:_,theme:"grid",headStyles:{fillColor:[150,150,150],textColor:255},styles:{fontSize:8,cellPadding:2},columnStyles:{0:{cellWidth:8},1:{cellWidth:80},2:{halign:"center"},3:{halign:"center",fontStyle:"bold"}},margin:{left:14,right:14},didDrawCell:x=>{if(x.section==="body"&&x.column.index===0){const W=x.row.index;if(W<H.length){const A=H[W][0],k=V(A),M=4,B=x.cell.x+(x.cell.width-M)/2,O=x.cell.y+(x.cell.height-M)/2;T.setFillColor(k),T.rect(B,O,M,M,"F")}}}}),e=T.lastAutoTable.finalY+10,b.tdsProfile&&(!t||t.aromaPercent===void 0||t.aftertastePercent===void 0||t.kickSuggestions&&t.kickSuggestions.some(W=>typeof W=="string")||t.qualitySuggestions&&t.qualitySuggestions.some(W=>typeof W=="string"))&&(console.log(`[PDF] Recalculating analysis for sample ${S+1} due to missing fields or legacy format.`),t=et({mode:b.tdsProfile.mode,events:b.tdsProfile.events,swallowTime:b.tdsProfile.swallowTime,totalDuration:b.tdsProfile.totalDuration})),t&&t.aromaNotes.length>0){const W=t.aromaNotes.map(A=>{const k=b.attributes.find(M=>M.id===A)||b.attributes.flatMap(M=>M.subAttributes||[]).find(M=>M.id===A);return k?R?k.nameEs:k.nameEn:A}).join(", ");if(W){const A=v(`Dominant Aromas (${t.aromaPercent}%)`,`Aromas Dominantes (${t.aromaPercent}%)`);d(A,W)}}if(t){const x={cacao:{en:"Cacao",es:"Cacao"},acidity:{en:"Acidity",es:"Acidez"},bitterness:{en:"Bitterness",es:"Amargor"},astringency:{en:"Astringency",es:"Astringencia"},roast:{en:"Roast",es:"Tostado"},fresh_fruit:{en:"Fresh Fruit",es:"Fruta Fresca"},browned_fruit:{en:"Browned Fruit",es:"Fruta Marrón"},vegetal:{en:"Vegetal",es:"Vegetal"},floral:{en:"Floral",es:"Floral"},woody:{en:"Woody",es:"Madera"},spice:{en:"Spice",es:"Especia"},nutty:{en:"Nutty",es:"Nuez"},caramel:{en:"Caramel",es:"Caramelo"},sweetness:{en:"Sweetness",es:"Dulzor"},defects:{en:"Defects",es:"Defectos"}};if(t.dominantAftertaste){const W=((E=x[t.dominantAftertaste])==null?void 0:E[R?"es":"en"])||t.dominantAftertaste,A=v(`Dominant Aftertaste (${t.aftertastePercent}%)`,`Post-gusto Dominante (${t.aftertastePercent}%)`);d(A,W)}if(t.aftertasteBoosts&&t.aftertasteBoosts.length>0){const W=t.aftertasteBoosts.map(A=>{var M;return`${((M=x[A.attrId])==null?void 0:M[R?"es":"en"])||A.attrId} +${A.amount}`}).join(", ");d(v("Aftertaste Boosts","Refuerzos de Post-gusto"),W)}if(t.qualityModifier!==0){const W=t.qualityModifier>0?"+":"";d(v("Suggested Global Quality Adjustment","Ajuste de Calidad Global Sugerido"),`${W}${t.qualityModifier}`)}if(t.kickSuggestions&&t.kickSuggestions.length>0){const W=t.kickSuggestions.map(A=>typeof A=="string"?A:A[R?"es":"en"]).join(`
`);d(v("Initial Kick Insights","Observaciones del Impacto Inicial"),W)}if(t.qualitySuggestions&&t.qualitySuggestions.length>0){const W=t.qualitySuggestions.map(A=>typeof A=="string"?A:A[R?"es":"en"]).join(`
`);d(v("Aftertaste Quality Insights","Observaciones de Calidad del Post-gusto"),W)}}}}T.setFontSize(8),T.setTextColor(150),T.text(`${v("Sample","Muestra")} ${S+1} / ${L.length}`,14,290,{align:"left"})}let I=N;if(!I){const S=dt();I=L.length===1?`CoEx_${L[0].metadata.sampleCode||"Report"}.pdf`:`CoEx_Bulk_Report_${S}.pdf`}I.toLowerCase().endsWith(".pdf")||(I+=".pdf"),T.save(I)};export{bt as generatePdf};
