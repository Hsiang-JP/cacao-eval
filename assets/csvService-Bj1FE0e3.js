import{I as u,a as _}from"./index-D5Fv_HC5.js";const b=(a,f)=>{const o=()=>{if(f==="es"&&a.date){const r=a.date.split("-");if(r.length===3)return`${r[2]}/${r[1]}/${r[0]}`}return a.date},n=new Map;a.attributes.forEach(r=>n.set(r.id,r));const e=(r,d)=>{var i;const s=n.get(r);return s?d&&s.subAttributes?((i=s.subAttributes.find(c=>c.id===d))==null?void 0:i.score)||0:s.score:0},t=(r,d)=>{var i,c;const s=n.get(r);return((c=(i=s==null?void 0:s.subAttributes)==null?void 0:i.find(l=>l.id===d))==null?void 0:c.description)||""};return["",o(),a.time,a.evaluator,a.sampleCode,a.sampleInfo,e("cacao"),e("acidity"),e("acidity","acid_fruity"),e("acidity","acid_acetic"),e("acidity","acid_lactic"),e("acidity","acid_mineral"),e("bitterness"),e("astringency"),e("fresh_fruit"),e("fresh_fruit","ff_berry"),e("fresh_fruit","ff_citrus"),e("fresh_fruit","ff_dark"),e("fresh_fruit","ff_pulp"),e("fresh_fruit","ff_tropical"),e("browned_fruit"),e("browned_fruit","bf_dried"),e("browned_fruit","bf_brown"),e("browned_fruit","bf_overripe"),e("vegetal"),e("vegetal","veg_green"),e("vegetal","veg_earthy"),e("floral"),e("floral","flo_orange"),e("floral","flo_flowers"),e("woody"),e("woody","wood_light"),e("woody","wood_dark"),e("woody","wood_resin"),e("spice"),e("spice","sp_spices"),e("spice","sp_tobacco"),e("spice","sp_savory"),e("nutty"),e("nutty","nut_meat"),e("nutty","nut_skin"),e("caramel"),e("sweetness"),e("roast"),e("defects"),e("defects","def_dirty"),e("defects","def_mold"),e("defects","def_moldy"),e("defects","def_meaty"),e("defects","def_over"),e("defects","def_manure"),e("defects","def_smoke"),e("defects","def_other"),`"${t("defects","def_other").replace(/"/g,'""')}"`,`"${a.notes.replace(/"/g,'""')}"`,`"${a.producerRecommendations.replace(/"/g,'""')}"`,a.globalQuality,a.selectedQualityId==="uniqueness"?10:0,a.selectedQualityId==="complexity"?10:0,a.selectedQualityId==="balance"?10:0,a.selectedQualityId==="cleanliness"?10:0,a.selectedQualityId==="q_acidity"?10:0,a.selectedQualityId==="q_astringency"?10:0,a.selectedQualityId==="q_bitterness"?10:0,a.selectedQualityId==="q_aftertaste"?10:0]},p=(a,f)=>{const o=(t,r,d)=>{if(t[r]!==void 0)return t[r];if(t[d]!==void 0)return t[d];const s=Object.keys(t).find(i=>i.trim()===r||i.trim()===d);return s?t[s]:""},n=(t,r,d)=>{const s=o(t,r,d),i=parseFloat(s);return isNaN(i)?0:i},e=JSON.stringify(u);return a.map(t=>{const r={sampleCode:o(t,"CoEx Sample Code","ID de muestra")||"Unknown",date:o(t,"Date Eval (press Ctrl and ;)","Fecha de evaluaci贸n"),time:o(t,"Time Eval (press Ctrl and :)","Hora de evaluaci贸n"),evaluator:o(t,"Panelist Initials","Evaluador"),evaluationType:"cacao_mass",sampleInfo:o(t,"Sample Information","Informaci贸n de muestra"),notes:o(t,"Overall Flavour comment","Comentario de sabor general"),producerRecommendations:o(t,"Feedback comment","Comentarios de comentarios"),globalQuality:n(t,"Global Quality (0 - 10)","Calidad global (0 - 10)"),language:f,selectedQualityId:void 0,attributes:JSON.parse(e)};if(r.date&&r.date.includes("/")){const i=r.date.split("/");i.length===3&&(r.date=`${i[2]}-${i[1]}-${i[0]}`)}r.attributes.forEach(i=>{i.score=n(t,i.csvHeaderEn,i.csvHeaderEs),i.subAttributes&&i.subAttributes.forEach(c=>{c.score=n(t,c.csvHeaderEn,c.csvHeaderEs),c.id==="def_other"&&(c.description=o(t,"Other Off-Flavour Description","Descripci贸n"))})});let d=0,s;return _.forEach(i=>{const c=n(t,i.csvHeaderEn,i.csvHeaderEs);c>d&&(d=c,s=i.id)}),d>0&&(r.selectedQualityId=s),r}).filter(t=>t.sampleCode&&t.sampleCode!=="Unknown")};export{b as generateCSVRow,p as parseSamplesFromCSV};
